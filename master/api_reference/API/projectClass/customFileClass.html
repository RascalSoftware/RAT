<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
                "http://www.w3.org/TR/REC-html40/loose.dtd">
<html>
<head>
  <title>Description of customFileClass</title>
  <meta name="keywords" content="customFileClass">
  <meta name="description" content="">
  <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
  <meta name="generator" content="m2html &copy; 2003-2019 Guillaume Flandin">
  <meta name="robots" content="index, follow">
  <link type="text/css" rel="stylesheet" href="../../m2html.css">
  <script type="text/javascript">
    if (top.frames.length == 0) { top.location = "../../index.html"; };
  </script>
</head>
<body>
<a name="_top"></a>
<!-- ../menu.html API -->
<!-- menu.html projectClass -->

<h1>customFileClass
</h1>

<h2><a name="_name"></a>PURPOSE <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
<div class="box"><strong></strong></div>

<h2><a name="_synopsis"></a>SYNOPSIS <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
<div class="box"><strong>This is a script file. </strong></div>

<h2><a name="_description"></a>DESCRIPTION <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
<div class="fragment"><pre class="comment"></pre></div>

<!-- crossreference -->
<h2><a name="_cross"></a>CROSS-REFERENCE INFORMATION <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
This function calls:
<ul style="list-style-image:url(../../matlabicon.gif)">
<li><a href="customFileClass.html" class="code" title="">customFileClass</a>	</li>
</ul>
This function is called by:
<ul style="list-style-image:url(../../matlabicon.gif)">
<li><a href="customFileClass.html" class="code" title="">customFileClass</a>	</li>
<li><a href="projectClass.html" class="code" title="">projectClass</a>	</li>
</ul>
<!-- crossreference -->

<h2><a name="_subfunctions"></a>SUBFUNCTIONS <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
<ul style="list-style-image:url(../../matlabicon.gif)">
<li><a href="#_sub1" class="code">function obj = customFileClass(varargin)</a></li>
<li><a href="#_sub2" class="code">function count = get.fileCount(obj)</a></li>
<li><a href="#_sub3" class="code">function obj = addCustomFile(obj,varargin)</a></li>
<li><a href="#_sub4" class="code">function obj = setCustomFile(obj, varargin)</a></li>
<li><a href="#_sub5" class="code">function removeCustomFile(obj, row)</a></li>
<li><a href="#_sub6" class="code">function names = getCustomNames(obj)</a></li>
<li><a href="#_sub7" class="code">function displayCustomFileObject(obj)</a></li>
<li><a href="#_sub8" class="code">function fileStruct = toStruct(obj)</a></li>
<li><a href="#_sub9" class="code">function obj = appendNewRow(obj,newRow)</a></li>
<li><a href="#_sub10" class="code">function obj = setCustomLanguage(obj,whichCustom,lang)</a></li>
<li><a href="#_sub11" class="code">function obj = setCustomName(obj,whichCustom,name)</a></li>
<li><a href="#_sub12" class="code">function obj = setFileName(obj,whichCustom,name)</a></li>
</ul>


<h2><a name="_source"></a>SOURCE CODE <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
<div class="fragment"><pre>0001 classdef <a href="customFileClass.html" class="code" title="">customFileClass</a> &lt; handle
0002     
0003     <span class="comment">% A container class for holding custom files for either</span>
0004     <span class="comment">% models, backgrounds or resolutions.</span>
0005 
0006     properties
0007         fileTable = table
0008     <span class="keyword">end</span>
0009 
0010     properties(Access = private, Constant, Hidden)
0011         duplicateNameMessage = &quot;Duplicate custom file names are not allowed&quot;
0012         invalidLanguageMessage = &quot;Language must be: matlab, python, or cpp&quot;
0013     <span class="keyword">end</span>
0014 
0015     properties(Access = private, Constant)
0016         supportedLanguages = {<span class="string">'matlab'</span>, <span class="string">'python'</span>, <span class="string">'cpp'</span>}
0017     <span class="keyword">end</span>
0018 
0019     properties (Access = private)
0020         autoFileNameCounter
0021     <span class="keyword">end</span>
0022 
0023     properties (Dependent, SetAccess = private)
0024         fileCount
0025     <span class="keyword">end</span>
0026     
0027     methods
0028         
0029         <a name="_sub0" href="#_subfunctions" class="code">function obj = customFileClass(varargin)</a>
0030             <span class="comment">% Construct a custom file class containing either an empty</span>
0031             <span class="comment">% table or one with a single row.</span>
0032             <span class="comment">% No input is required for an empty table, otherwise the</span>
0033             <span class="comment">% parameters for the first row should be provided.</span>
0034             <span class="comment">%</span>
0035             <span class="comment">% customFiles = customFileClass()</span>
0036             sz = [0 4];
0037             varTypes = {<span class="string">'string'</span>,<span class="string">'string'</span>,<span class="string">'string'</span>,<span class="string">'string'</span>};
0038             varNames = {<span class="string">'Name'</span>,<span class="string">'Filename'</span>,<span class="string">'Language'</span>,<span class="string">'Path'</span>};
0039             obj.fileTable = table(<span class="string">'Size'</span>,sz,<span class="string">'VariableTypes'</span>,varTypes,<span class="string">'VariableNames'</span>,varNames);
0040             obj.autoFileNameCounter = 1;
0041 
0042             <span class="keyword">if</span> ~isempty(varargin)
0043                 obj.addCustomFile(varargin{:});
0044             <span class="keyword">end</span>          
0045         <span class="keyword">end</span>
0046 
0047         <a name="_sub1" href="#_subfunctions" class="code">function count = get.fileCount(obj)</a>
0048             count = height(obj.fileTable);
0049         <span class="keyword">end</span>
0050 
0051         <a name="_sub2" href="#_subfunctions" class="code">function obj = addCustomFile(obj,varargin)</a>
0052             <span class="comment">% Add an entry to the file table.</span>
0053             <span class="comment">% A custom file entry can be added with no parameters, just the</span>
0054             <span class="comment">% name of the custom file entry, the name of the entry</span>
0055             <span class="comment">% alongside a filename, or can be fully defined by specifying</span>
0056             <span class="comment">% the name of the custom file entry, filename, language, and</span>
0057             <span class="comment">% file path</span>
0058             <span class="comment">%</span>
0059             <span class="comment">% customFiles.addCustomFile()</span>
0060             <span class="comment">% customFiles.addCustomFile('New Row')</span>
0061             <span class="comment">% customFiles.addCustomFile('New Row', 'file.m')</span>
0062             <span class="comment">% customFiles.addCustomFile('New Row', 'file.m', 'matlab', 'pwd')</span>
0063             <span class="keyword">if</span> isempty(varargin)
0064                 
0065                 <span class="comment">% Nothing supplied - add empty data row</span>
0066                 nameVal = obj.autoFileNameCounter();
0067                 newName = sprintf(<span class="string">'New custom file %d'</span>, nameVal);
0068                 
0069                 newRow = {newName, &quot;&quot;, &quot;matlab&quot;, &quot;pwd&quot;};
0070                 <a href="#_sub9" class="code" title="subfunction obj = appendNewRow(obj,newRow)">appendNewRow</a>(obj,newRow);
0071 
0072             <span class="keyword">else</span>
0073                 
0074                 inputs = varargin{:};
0075 
0076                 <span class="comment">% Check length of added data</span>
0077                 <span class="keyword">switch</span> length(inputs)
0078                     
0079                     <span class="keyword">case</span> 1
0080 
0081                         <span class="comment">% One input supplied - assume just name provided</span>
0082                         newName = inputs{1};
0083                         <span class="keyword">if</span> ~ischar(newName)
0084                             throw(invalidType(<span class="string">'Single input is expected to be a custom object name'</span>));
0085                         <span class="keyword">end</span>
0086                         
0087                         newRow = {newName,&quot;&quot;,&quot;matlab&quot;,&quot;pwd&quot;};
0088                         <a href="#_sub9" class="code" title="subfunction obj = appendNewRow(obj,newRow)">appendNewRow</a>(obj,newRow);
0089                         
0090                     <span class="keyword">case</span> 2
0091 
0092                         <span class="comment">% Two inputs suppled - assume both name and</span>
0093                         <span class="comment">% filename supplied;</span>
0094                         newName = string(inputs{1});
0095                         newFile = string(inputs{2});
0096 
0097                         newRow = {newName,newFile,&quot;matlab&quot;,&quot;pwd&quot;};
0098                         <a href="#_sub9" class="code" title="subfunction obj = appendNewRow(obj,newRow)">appendNewRow</a>(obj,newRow);
0099                         
0100                     <span class="keyword">case</span> 4
0101 
0102                         <span class="comment">% Four inputs = assume all inputs supplied</span>
0103                         newName = string(inputs{1});
0104                         newFile = string(inputs{2});
0105                         newLang = string(inputs{3});
0106                         newPath = string(inputs{4});
0107                         
0108                         newRow = {newName, newFile, newLang, newPath};
0109                         <a href="#_sub9" class="code" title="subfunction obj = appendNewRow(obj,newRow)">appendNewRow</a>(obj,newRow);
0110                         
0111                     <span class="keyword">otherwise</span>
0112 
0113                         <span class="comment">% Other length of inputs is not recognised</span>
0114                         throw(invalidNumberOfInputs(<span class="string">'Unrecognised input into addCustomFile'</span>));
0115                         
0116                 <span class="keyword">end</span>
0117             <span class="keyword">end</span>
0118             
0119         <span class="keyword">end</span>
0120         
0121         <a name="_sub3" href="#_subfunctions" class="code">function obj = setCustomFile(obj, varargin)</a>
0122             <span class="comment">% Change the value of a given parameter in the file table.</span>
0123             <span class="comment">% The expected inputs are the row of the file entry of</span>
0124             <span class="comment">% interest (given either by name of index), and key-value pairs</span>
0125             <span class="comment">% of the parameter(s) to change. The values of the keys are:</span>
0126             <span class="comment">% &quot;Name&quot;, &quot;Filename&quot;, &quot;Language&quot;, and &quot;Path&quot;.</span>
0127             <span class="comment">% NOTE changing the path using this routine is not implemented</span>
0128             <span class="comment">%</span>
0129             <span class="comment">% customFiles.setcustomFile(1, &quot;Name&quot;, &quot;New Name&quot;,...</span>
0130             <span class="comment">%                           &quot;Language&quot;, &quot;Octave&quot;)</span>
0131             inputs = varargin{:};
0132             customNames = obj.getCustomNames;
0133             
0134             <span class="comment">% Always need three or more inputs to set data value</span>
0135             <span class="keyword">if</span> length(inputs) &lt; 3
0136                 throw(invalidNumberOfInputs(<span class="string">'At least three inputs expected into ''setCustomFile'''</span>));
0137             <span class="keyword">end</span>
0138                 
0139             <span class="comment">% First input needs to be a data number or name</span>
0140             whichCustom = inputs{1};
0141             <span class="keyword">if</span> isnumeric(whichCustom)
0142                 <span class="keyword">if</span> (whichCustom &gt; obj.fileCount) || (whichCustom &lt; 1)
0143                     throw(indexOutOfRange(sprintf(<span class="string">'The index %d is not within the range 1 - %d'</span>, whichCustom, obj.fileCount)));
0144                 <span class="keyword">end</span>
0145             <span class="keyword">elseif</span> ischar(whichCustom)
0146                 <span class="keyword">if</span> ~strcmpi(whichCustom,customNames)
0147                     throw(nameNotRecognised(sprintf(<span class="string">'Custom file object name %s not recognised'</span>, whichCustom)));
0148                 <span class="keyword">else</span>
0149                     whichCustom = find(strcmpi(whichCustom,customNames));
0150                 <span class="keyword">end</span>
0151             <span class="keyword">end</span>
0152             
0153             <span class="comment">% Parse the remaining name value pairs to see what is</span>
0154             <span class="comment">% being set and make sure the data is of the correct size</span>
0155             <span class="comment">% and type.</span>
0156             toBeParsed = inputs(2:end);
0157 
0158             <span class="comment">% Make an 'inputParser' object...</span>
0159             p = inputParser;
0160 
0161             addParameter(p,<span class="string">'name'</span>,<span class="string">''</span>, @(x) isstring(x) || ischar(x))
0162             addParameter(p,<span class="string">'filename'</span>,<span class="string">''</span>, @(x) isstring(x) || ischar(x))
0163             addParameter(p,<span class="string">'language'</span>,<span class="string">''</span>, @(x) isstring(x) || ischar(x))
0164             addParameter(p,<span class="string">'path'</span>,<span class="string">''</span>, @(x) isstring(x) || ischar(x)) 
0165             parse(p,toBeParsed{:});
0166                 
0167             results = p.Results;
0168             
0169             <span class="comment">% Any fields in results that are not empty are being set,</span>
0170             <span class="comment">% so call the relevant set method for these (which will carry</span>
0171             <span class="comment">% out some additional checks)</span>
0172             <span class="keyword">if</span> ~isempty(results.filename)
0173                 obj.setFileName(whichCustom,results.filename);
0174             <span class="keyword">end</span>
0175             
0176             <span class="keyword">if</span> ~isempty(results.language)
0177                 obj.setCustomLanguage(whichCustom,results.language);
0178             <span class="keyword">end</span>
0179             
0180             <span class="keyword">if</span> ~isempty(results.path)
0181                 <span class="comment">% NOT IMPLEMENTED</span>
0182                 obj.setCustomPath(whichCustom,results.path);
0183             <span class="keyword">end</span>
0184             
0185             <span class="keyword">if</span> ~isempty(results.name)
0186                 obj.setCustomName(whichCustom,results.name);
0187             <span class="keyword">end</span>            
0188 
0189         <span class="keyword">end</span>
0190 
0191         <a name="_sub4" href="#_subfunctions" class="code">function removeCustomFile(obj, row)</a>
0192             <span class="comment">% Removes a file entry from the file table. The expected input</span>
0193             <span class="comment">% is an integer or array of integers, i.e., an input such as</span>
0194             <span class="comment">% [1 3] leads to multiple rows being removed from the table</span>
0195             <span class="comment">%</span>
0196             <span class="comment">% customFiles.removeCustomFile(2)</span>
0197             tab = obj.fileTable;
0198             tab(row,:) = [];
0199             obj.fileTable = tab;
0200         <span class="keyword">end</span>
0201 
0202         <a name="_sub5" href="#_subfunctions" class="code">function names = getCustomNames(obj)</a>
0203             <span class="comment">% Get a string array of the names of each of the custom file</span>
0204             <span class="comment">% objects defined in the class.</span>
0205             <span class="comment">%</span>
0206             <span class="comment">% customFiles.getLayersNames()</span>
0207             names = obj.fileTable{:,1};  
0208         <span class="keyword">end</span>
0209 
0210         <a name="_sub6" href="#_subfunctions" class="code">function displayCustomFileObject(obj)</a>
0211             <span class="comment">% Display the file table.</span>
0212             <span class="comment">%</span>
0213             <span class="comment">% customFiles.displayCustomFileObject()</span>
0214             fprintf(<span class="string">'    Custom Files: ------------------------------------------------------------------------------------------------------ \n\n'</span>);
0215             
0216             tab = obj.fileTable;
0217             
0218             sz = [1,4];
0219             displayVarTypes = {<span class="string">'string'</span>,<span class="string">'string'</span>,<span class="string">'string'</span>,<span class="string">'string'</span>}; 
0220             displayVarNames = {<span class="string">'Name'</span>,<span class="string">'Filename'</span>,<span class="string">'Language'</span>,<span class="string">'Path'</span>};
0221             displayTable = table(<span class="string">'Size'</span>,sz,<span class="string">'VariableTypes'</span>,displayVarTypes,<span class="string">'VariableNames'</span>,displayVarNames);
0222             
0223             tableSize = size(tab);
0224             
0225             <span class="keyword">if</span> tableSize(1) == 0
0226                 displayTable(1,:) = {<span class="string">''</span>,<span class="string">''</span>,<span class="string">''</span>,<span class="string">''</span>};
0227             <span class="keyword">else</span>
0228                 
0229                 <span class="keyword">for</span> i = 1:tableSize(1)
0230                     thisRow = tab(i,:);
0231                     
0232                     nameString = thisRow{1,1};
0233                     
0234                     thisCustomFile = thisRow{1,2}{:};
0235                     <span class="keyword">if</span> isempty(thisCustomFile)
0236                         fileNameString = &quot;No File&quot;;
0237                     <span class="keyword">else</span>
0238                         fileNameString = string(thisCustomFile);
0239                     <span class="keyword">end</span>
0240                     
0241                     thisFileLanguage = thisRow{1,3}{:};
0242                     <span class="keyword">if</span> isempty(thisFileLanguage)
0243                         fileLanguageString = &quot;-&quot;;
0244                     <span class="keyword">else</span>
0245                         fileLanguageString = thisFileLanguage;
0246                     <span class="keyword">end</span>
0247                     
0248                     thisFilePath = thisRow{1,4}{:};
0249                     <span class="keyword">if</span> isempty(thisFilePath)
0250                         filePathString = &quot;pwd&quot;;
0251                     <span class="keyword">else</span>
0252                         thisFilePath = char(thisFilePath);
0253                         <span class="keyword">if</span> length(thisFilePath) &gt; 10
0254                             thisFilePath = [<span class="string">'...'</span> thisFilePath(end-10:end)];
0255                         <span class="keyword">end</span>
0256                         filePathString = string(thisFilePath);
0257                     <span class="keyword">end</span>
0258                     
0259                     newDisplayRow = {nameString, fileNameString, fileLanguageString, filePathString};
0260                     displayTable(i,:) = newDisplayRow;
0261                     
0262                 <span class="keyword">end</span>
0263             <span class="keyword">end</span>
0264 
0265             disp(displayTable);
0266             fprintf(<span class="string">'\n'</span>);
0267  
0268         <span class="keyword">end</span>
0269         
0270         <a name="_sub7" href="#_subfunctions" class="code">function fileStruct = toStruct(obj)</a>
0271             <span class="comment">% Convert the custom files class to a struct</span>
0272             <span class="comment">%</span>
0273             <span class="comment">% customFiles.toStruct()</span>
0274             numberOfFiles = obj.fileCount;
0275             
0276             <span class="keyword">if</span> numberOfFiles &gt; 0
0277                 filesList = cell(numberOfFiles, 1);
0278                 <span class="keyword">for</span> i = 1:numberOfFiles
0279                     thisRow = obj.fileTable{i,:};
0280                     thisFile = thisRow{2};
0281                     thisType = thisRow{3};
0282                     thisPath = thisRow{4};
0283                     
0284                     <span class="keyword">if</span> strcmpi(thisPath,<span class="string">'pwd'</span>)
0285                         thisPath = pwd;
0286                     <span class="keyword">end</span>
0287                     filesList{i} = {thisFile, thisType, thisPath};
0288                 <span class="keyword">end</span>
0289                 fileStruct.files = filesList;
0290             <span class="keyword">else</span>
0291                 fileStruct.files = {};
0292             <span class="keyword">end</span>
0293         <span class="keyword">end</span>
0294 
0295     <span class="keyword">end</span>
0296 
0297     methods(Access = protected)
0298 
0299         <a name="_sub8" href="#_subfunctions" class="code">function obj = appendNewRow(obj,newRow)</a>
0300             <span class="comment">% Appends a row to the layers table. The expected input is</span>
0301             <span class="comment">% a length four cell array.</span>
0302             <span class="comment">%</span>
0303             <span class="comment">% customFiles.appendNewRow({'New Row','file.m','matlab','pwd'});</span>
0304             tab = obj.fileTable;
0305             newName = newRow{1};
0306             <span class="keyword">if</span> any(strcmpi(newName,tab{:,1}))
0307                 throw(duplicateName(obj.duplicateNameMessage));
0308             <span class="keyword">end</span>
0309             
0310             <span class="comment">% Carry out checks of Data type and ranges</span>
0311             fileName = newRow{2};
0312             language = newRow{3};
0313             path = newRow{4};
0314 
0315             <span class="keyword">if</span> ~strcmpi(language, obj.supportedLanguages)
0316                 throw(invalidOption(obj.invalidLanguageMessage));
0317             <span class="keyword">end</span>
0318 
0319             row = {newName, fileName, language, path};
0320             tab = [tab ; row];
0321             obj.fileTable = tab;
0322             obj.autoFileNameCounter = obj.autoFileNameCounter + 1;
0323             
0324         <span class="keyword">end</span>
0325 
0326         <a name="_sub9" href="#_subfunctions" class="code">function obj = setCustomLanguage(obj,whichCustom,lang)</a>
0327            <span class="comment">% Check whether a specified language is supported, and set the</span>
0328            <span class="comment">% file entry if so.</span>
0329            <span class="keyword">if</span> ~strcmpi(lang, obj.supportedLanguages)
0330                throw(invalidOption(obj.invalidLanguageMessage));
0331            <span class="keyword">end</span>
0332            
0333            obj.fileTable{whichCustom,3} = {lang};
0334         <span class="keyword">end</span>
0335         
0336         
0337         <a name="_sub10" href="#_subfunctions" class="code">function obj = setCustomName(obj,whichCustom,name) </a>
0338             <span class="comment">% Check a potential new name is already</span>
0339             <span class="comment">% specified, and set it if not</span>
0340 
0341             <span class="comment">% Name must not be an existing name</span>
0342             existingNames = obj.fileTable{:,1};
0343             <span class="keyword">if</span> any(strcmpi(name,existingNames))
0344                 throw(duplicateName(obj.duplicateNameMessage));
0345             <span class="keyword">end</span>
0346             
0347             <span class="comment">% Set the relevant name</span>
0348             obj.fileTable{whichCustom,1} = {name};
0349         <span class="keyword">end</span>
0350         
0351         
0352         <a name="_sub11" href="#_subfunctions" class="code">function obj = setFileName(obj,whichCustom,name)</a>
0353             <span class="comment">% Set a new filename</span>
0354             obj.fileTable{whichCustom,2} = {name};  
0355         <span class="keyword">end</span>
0356 
0357     <span class="keyword">end</span>
0358     
0359 <span class="keyword">end</span>
0360     
</pre></div>

<hr><address>Generated on Fri 10-Mar-2023 11:17:15 by <strong><a href="https://github.com/gllmflndn/m2html">m2html</a></strong> &copy; 2003-2022</address>
</body>
</html>

<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
                "http://www.w3.org/TR/REC-html40/loose.dtd">
<html>
<head>
  <title>Description of customFileClass</title>
  <meta name="keywords" content="customFileClass">
  <meta name="description" content="">
  <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
  <meta name="generator" content="m2html &copy; 2003-2019 Guillaume Flandin">
  <meta name="robots" content="index, follow">
  <link type="text/css" rel="stylesheet" href="../../m2html.css">
  <script type="text/javascript">
    if (top.frames.length == 0) { top.location = "../../index.html"; };
  </script>
</head>
<body>
<a name="_top"></a>
<!-- # API --><!-- # projectClass -->
<h1>customFileClass
</h1>

<h2><a name="_name"></a>PURPOSE <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
<div class="box"><strong></strong></div>

<h2><a name="_synopsis"></a>SYNOPSIS <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
<div class="box"><strong>This is a script file. </strong></div>

<h2><a name="_description"></a>DESCRIPTION <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
<div class="fragment"><pre class="comment"></pre></div>

<!-- crossreference -->
<h2><a name="_cross"></a>CROSS-REFERENCE INFORMATION <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
This function calls:
<ul style="list-style-image:url(../../matlabicon.gif)">
<li><a href="customFileClass.html" class="code" title="">customFileClass</a>	</li></ul>
This function is called by:
<ul style="list-style-image:url(../../matlabicon.gif)">
<li><a href="customFileClass.html" class="code" title="">customFileClass</a>	</li><li><a href="projectClass.html" class="code" title="">projectClass</a>	</li></ul>
<!-- crossreference -->

<h2><a name="_subfunctions"></a>SUBFUNCTIONS <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
<ul style="list-style-image:url(../../matlabicon.gif)">
<li><a href="#_sub1" class="code">function obj = customFileClass(varargin)</a></li><li><a href="#_sub2" class="code">function obj = addFile(obj,varargin)</a></li><li><a href="#_sub3" class="code">function obj = setCustomFile(obj, varargin)</a></li><li><a href="#_sub4" class="code">function obj = setCustomLanguage(obj,whichCustom,lang)</a></li><li><a href="#_sub5" class="code">function obj = setCustomName(obj,whichCustom,name)</a></li><li><a href="#_sub6" class="code">function obj = setFileName(obj,whichCustom,name)</a></li><li><a href="#_sub7" class="code">function names = getCustomNames(obj)</a></li><li><a href="#_sub8" class="code">function displayCustomFileObject(obj)</a></li><li><a href="#_sub9" class="code">function fileStruct = toStruct(obj)</a></li><li><a href="#_sub10" class="code">function obj = appendNewRow(obj,newRow)</a></li><li><a href="#_sub11" class="code">function inputBlock = parseDataInput(inputVals)</a></li></ul>

<h2><a name="_source"></a>SOURCE CODE <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
<div class="fragment"><pre>0001 classdef <a href="customFileClass.html" class="code" title="">customFileClass</a> &lt; handle
0002     
0003     <span class="comment">% A container class for holding customf files for either</span>
0004     <span class="comment">% models, backgrounds or resolutions.</span>
0005     properties
0006         
0007         fileTable;
0008         fileCount = 0;
0009         autoFileNameCounter;
0010         
0011     <span class="keyword">end</span>
0012     
0013     methods
0014         
0015         <a name="_sub0" href="#_subfunctions" class="code">function obj = customFileClass(varargin)</a>
0016             
0017             <span class="keyword">if</span> ~isempty(varargin)
0018                 startCell = varargin{:};
0019                 nStartRows = 1;
0020             <span class="keyword">else</span>
0021                 startCell = [];
0022                 nStartRows = 0;
0023             <span class="keyword">end</span>
0024             
0025             sz = [nStartRows 4];
0026             varTypes = {<span class="string">'string'</span>,<span class="string">'string'</span>,<span class="string">'string'</span>,<span class="string">'string'</span>};
0027             varNames = {<span class="string">'Name'</span>,<span class="string">'Filename'</span>,<span class="string">'Language'</span>,<span class="string">'path'</span>};
0028             obj.fileTable = table(<span class="string">'Size'</span>,sz,<span class="string">'VariableTypes'</span>,varTypes,<span class="string">'VariableNames'</span>,varNames);
0029             
0030             <span class="keyword">if</span> ~isempty(startCell)
0031                 obj.fileTable(1,:) = startCell;<span class="comment">%{'Substrate Roughness',1 3 5,true,'uniform',0,Inf};</span>
0032                 obj.fileCount = 1;
0033                 obj.autoFileNameCounter = 1;
0034             <span class="keyword">else</span>
0035                 obj.fileCount = 0;
0036                 obj.autoFileNameCounter = 1;
0037             <span class="keyword">end</span>
0038             
0039         <span class="keyword">end</span>
0040         
0041         <a name="_sub1" href="#_subfunctions" class="code">function obj = addFile(obj,varargin)</a>
0042             
0043             <span class="keyword">if</span> isempty(varargin)
0044                 
0045                 <span class="comment">% Nothing supplied - add empty data row</span>
0046                 nameVal = obj.autoFileNameCounter();
0047                 newName = sprintf(<span class="string">'New custom file %d'</span>, nameVal);
0048                 
0049                 newRow = {newName, &quot;&quot;, &quot;Octave&quot;, &quot;pwd&quot;};
0050                 <a href="#_sub10" class="code" title="subfunction obj = appendNewRow(obj,newRow)">appendNewRow</a>(obj,newRow);
0051             <span class="keyword">else</span>
0052                 
0053                 inputs = varargin;
0054                 
0055                 <span class="comment">% Check length of added data</span>
0056                 <span class="keyword">switch</span> length(inputs)
0057                     
0058                     <span class="keyword">case</span> 1
0059                         
0060                         <span class="comment">% One input supplied - assume just name provided</span>
0061                         newName = inputs{1};
0062                         <span class="keyword">if</span> ~ischar(newName)
0063                             error(<span class="string">'Single input is expected to be a custom object name'</span>);
0064                         <span class="keyword">end</span>
0065                         
0066                         newRow = {newName,&quot;&quot;,&quot;matlab&quot;,&quot;pwd&quot;};
0067                         <a href="#_sub10" class="code" title="subfunction obj = appendNewRow(obj,newRow)">appendNewRow</a>(obj,newRow);<span class="comment">%,newUserDataRow);</span>
0068                         
0069                     <span class="keyword">case</span> 2
0070                         
0071                         <span class="comment">% Two inputs suppled - assume both name and</span>
0072                         <span class="comment">% filename supplied;</span>
0073                         newName = string(inputs{1});
0074                         newFile = string(inputs{2});
0075                         
0076                         
0077                         
0078                         newRow = {newName, newFile,&quot;octave&quot;,&quot;pwd&quot;};
0079                         <a href="#_sub10" class="code" title="subfunction obj = appendNewRow(obj,newRow)">appendNewRow</a>(obj,newRow);<span class="comment">% ,newUserDataRow);</span>
0080                         
0081                     <span class="keyword">case</span> 4
0082                         <span class="comment">% Four inputs = assume all inputs supplied</span>
0083                         newName = string(inputs{1});
0084                         newFile = string(inputs{2});
0085                         newLang = string(inputs{3});
0086                         newPath = string(inputs{4});
0087                         
0088                         newRow = {newName, newFile, newLang, newPath };
0089                         <a href="#_sub10" class="code" title="subfunction obj = appendNewRow(obj,newRow)">appendNewRow</a>(obj,newRow);
0090                         
0091                     <span class="keyword">otherwise</span>
0092                         
0093                         <span class="comment">% Other length of inputs is not recognised</span>
0094                         error(<span class="string">'Unrecognised input into addData'</span>);
0095                         
0096                 <span class="keyword">end</span>
0097             <span class="keyword">end</span>
0098             
0099         <span class="keyword">end</span>
0100         
0101         <a name="_sub2" href="#_subfunctions" class="code">function obj = setCustomFile(obj, varargin)</a>
0102            
0103             <span class="comment">% Set the value of an existing custom file object</span>
0104             inputs = varargin{:};
0105             customNames = obj.fileTable{:,1};
0106             
0107             <span class="comment">% Always need three or more inputs to set data value</span>
0108             <span class="keyword">if</span> length(inputs) &lt; 3
0109                 error(<span class="string">'At least three inputs expected into ''setCustomFile'''</span>);
0110             <span class="keyword">end</span>
0111                 
0112             <span class="comment">% First input needs to be a data number or name</span>
0113             whichCustom = inputs{1};
0114             <span class="keyword">if</span> isnumeric(whichCustom)
0115                 <span class="keyword">if</span> (whichCustom &gt; obj.fileCount) || (whichCustom &lt; 1)
0116                     error(<span class="string">'Custom file object %d is not recognised'</span>, whichCustom);
0117                 <span class="keyword">end</span>
0118             <span class="keyword">elseif</span> ischar(whichCustom)
0119                 <span class="keyword">if</span> ~strcmpi(whichCustom,customNames)
0120                     error(<span class="string">'Data name %s not recognised'</span>, whichCustom);
0121                 <span class="keyword">end</span>
0122             <span class="keyword">end</span>
0123             
0124             <span class="comment">% Parse the remaining name value pairs to see what is</span>
0125             <span class="comment">% being set and make sure the data is of the correct size</span>
0126             <span class="comment">% and type.</span>
0127             toBeParsed = inputs(2:end);
0128             
0129            
0130 
0131             <span class="comment">% Make an 'iputParser' object...</span>
0132             p = inputParser;
0133             
0134 <span class="comment">%             % dataRange and simRange need to be [1 x 2] arrays</span>
0135 <span class="comment">%             isDimsRanges = @(x)all(size(x) == [1,2]);</span>
0136             
0137 <span class="comment">%             % Data needs to be an [n x &gt;3] array</span>
0138 <span class="comment">%             isDimsData = @(x) size(x,2) &gt; 3;</span>
0139 
0140             addParameter(p,<span class="string">'name'</span>,<span class="string">''</span>, @(x) isstring(x) || ischar(x))
0141             addParameter(p,<span class="string">'filename'</span>,<span class="string">''</span>, @(x) isstring(x) || ischar(x))
0142             addParameter(p,<span class="string">'language'</span>,<span class="string">''</span>, @(x) isstring(x) || ischar(x))
0143             addParameter(p,<span class="string">'path'</span>,<span class="string">''</span>, @(x) isstring(x) || ischar(x)) 
0144             parse(p,toBeParsed{:});
0145                 
0146             results = p.Results;
0147             
0148             <span class="comment">% Any fields in results that are not empty are being set,</span>
0149             <span class="comment">% so call the relevant set method for these (which will carry</span>
0150             <span class="comment">% out some additional checks)</span>
0151             
0152             <span class="comment">% Pass numeric identifyer for data into subfunctions</span>
0153             <span class="keyword">if</span> ~isnumeric(whichCustom)
0154                 whichCustom = find(strcmpi(whichCustom,customNames));
0155             <span class="keyword">end</span>
0156             
0157             <span class="keyword">if</span> ~isempty(results.filename)
0158                 obj.setFileName(whichCustom,results.filename);
0159             <span class="keyword">end</span>
0160             
0161             <span class="keyword">if</span> ~isempty(results.language)
0162                 obj.setCustomLanguage(whichCustom,results.language);
0163             <span class="keyword">end</span>
0164             
0165             <span class="keyword">if</span> ~isempty(results.path)
0166                 obj.setCustomPath(whichCustom,results.path);
0167             <span class="keyword">end</span>
0168             
0169             <span class="keyword">if</span> ~isempty(results.name)
0170                 obj.setCustomName(whichCustom,results.name);
0171             <span class="keyword">end</span>            
0172 
0173         <span class="keyword">end</span>
0174         
0175 <span class="comment">%         function obj = setDataRange(obj,whichData,range)</span>
0176 <span class="comment">%</span>
0177 <span class="comment">%             r = [range(1) range(2)];</span>
0178 <span class="comment">%             obj.dataTable{whichData,3} = {range};</span>
0179 <span class="comment">%</span>
0180 <span class="comment">%         end</span>
0181 
0182         <a name="_sub3" href="#_subfunctions" class="code">function obj = setCustomLanguage(obj,whichCustom,lang)</a>
0183             
0184            <span class="keyword">if</span> ~strcmpi(lang,{<span class="string">'octave'</span>,<span class="string">'matlab'</span>,<span class="string">'python'</span>,<span class="string">'cpp'</span>})
0185                error(<span class="string">'Language must be octave, matlab,cpp or python'</span>);
0186            <span class="keyword">end</span>
0187            
0188            obj.fileTable{whichCustom,3} = {lang};
0189            
0190         <span class="keyword">end</span>
0191         
0192         
0193         <a name="_sub4" href="#_subfunctions" class="code">function obj = setCustomName(obj,whichCustom,name)</a>
0194             
0195             <span class="comment">% Name must be a char and not an existing name</span>
0196             <span class="keyword">if</span> ~ischar(name)
0197                 error(<span class="string">'Name must be a string / character array'</span>);
0198             <span class="keyword">end</span>
0199             
0200             existingNames = obj.getCustomNames;
0201             <span class="keyword">if</span> strcmpi(name,existingNames)
0202                 error(<span class="string">'Duplicate custom names are not allowed'</span>);
0203             <span class="keyword">end</span>
0204             
0205             <span class="comment">% Set the relevant name</span>
0206             obj.fileTable{whichCustom,1} = {name};
0207             
0208         <span class="keyword">end</span>
0209         
0210         
0211         <a name="_sub5" href="#_subfunctions" class="code">function obj = setFileName(obj,whichCustom,name)</a>
0212             
0213             <span class="comment">% Name must be a char and not an existing name</span>
0214             <span class="keyword">if</span> ~ischar(name)
0215                 error(<span class="string">'Filename must be a string / character array'</span>);
0216             <span class="keyword">end</span>
0217            
0218             
0219             <span class="comment">% Set the relevant file name</span>
0220             obj.fileTable{whichCustom,2} = {name};
0221             
0222         <span class="keyword">end</span>
0223         
0224         
0225         
0226         
0227         
0228         <a name="_sub6" href="#_subfunctions" class="code">function names = getCustomNames(obj)</a>
0229             
0230            names = obj.fileTable{:,1}; 
0231             
0232         <span class="keyword">end</span>
0233         
0234         
0235         <a name="_sub7" href="#_subfunctions" class="code">function displayCustomFileObject(obj)</a>
0236             
0237             <span class="comment">% Display the table object.</span>
0238             
0239             fprintf(<span class="string">'    Custom Files: ------------------------------------------------------------------------------------------------------ \n\n'</span>);
0240             
0241             tab = obj.fileTable;
0242             
0243             sz = [1,4];
0244             displayVarTypes = {<span class="string">'string'</span>,<span class="string">'string'</span>,<span class="string">'string'</span>,<span class="string">'string'</span>}; 
0245             displayVarNames = {<span class="string">'Name'</span>,<span class="string">'Filename'</span>,<span class="string">'Language'</span>,<span class="string">'Path'</span>};
0246             displayTable = table(<span class="string">'Size'</span>,sz,<span class="string">'VariableTypes'</span>,displayVarTypes,<span class="string">'VariableNames'</span>,displayVarNames);
0247             
0248             tableSize = size(tab);
0249             
0250             <span class="keyword">if</span> tableSize(1) == 0
0251                 displayTable(1,:) = {&quot;&quot;,&quot;&quot;,&quot;&quot;,&quot;&quot;};
0252             <span class="keyword">else</span>
0253                 
0254                 <span class="keyword">for</span> i = 1:tableSize(1)
0255                     thisRow = tab(i,:);
0256                     
0257                     nameString = thisRow{1,1};
0258                     
0259                     thisCustomFile = thisRow{1,2}{:};
0260                     <span class="keyword">if</span> isempty(thisCustomFile)
0261                         fileNameString = &quot;No File&quot;;
0262                     <span class="keyword">else</span>
0263                         fileNameString = string(thisCustomFile);
0264                     <span class="keyword">end</span>
0265                     
0266                     thisFileLanguage = thisRow{1,3}{:};
0267                     <span class="keyword">if</span> isempty(thisFileLanguage)
0268                         fileLanguageString = &quot;-&quot;;
0269                     <span class="keyword">else</span>
0270                         fileLanguageString = thisFileLanguage;
0271                     <span class="keyword">end</span>
0272                     
0273                     thisFilePath = thisRow{1,4}{:};
0274                     <span class="keyword">if</span> isempty(thisFilePath)
0275                         filePathString = &quot;pwd&quot;;
0276                     <span class="keyword">else</span>
0277                         thisFilePath = char(thisFilePath);
0278                         <span class="keyword">if</span> length(thisFilePath) &gt; 10
0279                             thisFilePath = [<span class="string">'...'</span> thisFilePath(end-10:end)];
0280                         <span class="keyword">end</span>
0281                         filePathString = string(thisFilePath);
0282                     <span class="keyword">end</span>
0283                     
0284                     newDisplayRow = {nameString, fileNameString, fileLanguageString, filePathString};
0285                     displayTable(i,:) = newDisplayRow;
0286                     
0287                 <span class="keyword">end</span>
0288             <span class="keyword">end</span>
0289 
0290             disp(displayTable);
0291             fprintf(<span class="string">'\n'</span>);
0292  
0293         <span class="keyword">end</span>
0294         
0295         <a name="_sub8" href="#_subfunctions" class="code">function fileStruct = toStruct(obj)</a>
0296             
0297             numberOfFiles = obj.fileCount;
0298             
0299             <span class="keyword">if</span> numberOfFiles &gt; 0
0300                 <span class="keyword">for</span> i = 1:numberOfFiles
0301                     thisRow = obj.fileTable{i,:};
0302                     thisFile = thisRow{2};
0303                     thisType = thisRow{3};
0304                     thisPath = thisRow{4};
0305                     
0306                     <span class="keyword">if</span> strcmpi(thisPath,<span class="string">'pwd'</span>)
0307                         thisPath = pwd;
0308                     <span class="keyword">end</span>
0309                     filesList{i,:} = {thisFile, thisType, thisPath};
0310                 <span class="keyword">end</span>
0311                 fileStruct.files = filesList;
0312             <span class="keyword">else</span>
0313                 fileStruct.files = {};
0314             <span class="keyword">end</span>
0315             
0316         <span class="keyword">end</span>
0317         
0318         <a name="_sub9" href="#_subfunctions" class="code">function obj = appendNewRow(obj,newRow)</a>
0319             
0320             tab = obj.fileTable;
0321             newName = newRow{1};
0322             <span class="keyword">if</span> any(strcmpi(newName,tab{:,1}))
0323                 error(<span class="string">'Duplicate custom file names not allowed'</span>);
0324             <span class="keyword">end</span>
0325             
0326             <span class="comment">% Carry out checks of Data type and ranges</span>
0327             fileName = newRow{2};
0328             language = newRow{3};
0329             path = newRow{4};
0330                 
0331             <span class="keyword">if</span> ~isstring(fileName)
0332                 error(<span class="string">'filename must be a string'</span>);
0333             <span class="keyword">end</span>
0334             
0335             <span class="keyword">if</span> ~strcmpi(language,{<span class="string">'matlab'</span>,<span class="string">'octave'</span>,<span class="string">'python'</span>,<span class="string">'cpp'</span>})
0336                 error(<span class="string">'Custom file must be matlab, octave,cpp or python'</span>);
0337             <span class="keyword">end</span>
0338             
0339             <span class="keyword">if</span> ~isstring(path)
0340                 error(<span class="string">'Path mjst be a string'</span>);
0341             <span class="keyword">end</span>
0342 
0343             row = {{newName}, {fileName}, {language}, {path}};
0344             tab = [tab ; row];
0345             obj.fileTable = tab;
0346             obj.fileCount = obj.fileCount + 1;
0347             obj.autoFileNameCounter = obj.autoFileNameCounter + 1;
0348             
0349         <span class="keyword">end</span>
0350         
0351     <span class="keyword">end</span>
0352     
0353 <span class="keyword">end</span>
0354 
0355 <a name="_sub10" href="#_subfunctions" class="code">function inputBlock = parseDataInput(inputVals)</a>
0356 
0357     defaultName = <span class="string">''</span>;
0358     defaultData = [];
0359     defaultRange = [obj.defaultSimMin obj.defaultSimMax];
0360     defaultSimRange = [obj.defaultSimMin obj.defaultSimMax];
0361 
0362     p = inputParser;
0363     addParameter(p,<span class="string">'name'</span>, defaultName, @ischar);
0364     addParameter(p,<span class="string">'data'</span>, defaultData, @isnumeric);
0365     addParameter(p,<span class="string">'data range'</span>, defaultRange, @(a) validateattributes(a,{<span class="string">'double'</span>},{<span class="string">'size'</span>,[1 2]}));
0366     addParameter(p,<span class="string">'sim range'</span>, defaultSimRange, @(a) validateattributes(a,{<span class="string">'double'</span>},{<span class="string">'size'</span>,[1 2]}));
0367 
0368     parse(p,inputVals{:});
0369     inputBlock = p.Results;
0370 
0371 <span class="keyword">end</span>
0372 
0373</pre></div>
<hr><address>Generated on Thu 28-Jul-2022 16:33:05 by <strong><a href="https://www.artefact.tk/software/matlab/m2html/" target="_parent">m2html</a></strong> &copy; 2003-2019</address>
</body>
</html>
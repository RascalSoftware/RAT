<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
                "http://www.w3.org/TR/REC-html40/loose.dtd">
<html>
<head>
  <title>Description of projectClass</title>
  <meta name="keywords" content="projectClass">
  <meta name="description" content="">
  <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
  <meta name="generator" content="m2html &copy; 2003-2019 Guillaume Flandin">
  <meta name="robots" content="index, follow">
  <link type="text/css" rel="stylesheet" href="../../m2html.css">
  <script type="text/javascript">
    if (top.frames.length == 0) { top.location = "../../index.html"; };
  </script>
</head>
<body>
<a name="_top"></a>
<!-- ../menu.html API -->
<!-- menu.html projectClass -->

<h1>projectClass
</h1>

<h2><a name="_name"></a>PURPOSE <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
<div class="box"><strong></strong></div>

<h2><a name="_synopsis"></a>SYNOPSIS <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
<div class="box"><strong>This is a script file. </strong></div>

<h2><a name="_description"></a>DESCRIPTION <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
<div class="fragment"><pre class="comment"></pre></div>

<!-- crossreference -->
<h2><a name="_cross"></a>CROSS-REFERENCE INFORMATION <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
This function calls:
<ul style="list-style-image:url(../../matlabicon.gif)">
<li><a href="backgroundsClass.html" class="code" title="">backgroundsClass</a>	</li>
<li><a href="contrastsClass.html" class="code" title="">contrastsClass</a>	</li>
<li><a href="customFileClass.html" class="code" title="">customFileClass</a>	</li>
<li><a href="dataClass.html" class="code" title="">dataClass</a>	</li>
<li><a href="domainsClass.html" class="code" title="">domainsClass</a>	</li>
<li><a href="layersClass.html" class="code" title="">layersClass</a>	</li>
<li><a href="mergeStructs.html" class="code" title="function outStruct = mergeStructs(varargin)">mergeStructs</a>	</li>
<li><a href="parametersClass.html" class="code" title="">parametersClass</a>	</li>
<li><a href="projectClass.html" class="code" title="">projectClass</a>	</li>
<li><a href="resolutionsClass.html" class="code" title="">resolutionsClass</a>	</li>
</ul>
This function is called by:
<ul style="list-style-image:url(../../matlabicon.gif)">
<li><a href="../../API/project.html" class="code" title="function obj = project(options)">project</a>	Creates a project object.</li>
<li><a href="domainsClass.html" class="code" title="">domainsClass</a>	</li>
<li><a href="projectClass.html" class="code" title="">projectClass</a>	</li>
</ul>
<!-- crossreference -->

<h2><a name="_subfunctions"></a>SUBFUNCTIONS <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
<ul style="list-style-image:url(../../matlabicon.gif)">
<li><a href="#_sub1" class="code">function obj = projectClass(experimentName, calculationType, geometry, absorption)</a></li>
<li><a href="#_sub2" class="code">function domainsObj = toDomainsClass(obj)</a></li>
<li><a href="#_sub3" class="code">function obj = setUsePriors(obj, showFlag)</a></li>
<li><a href="#_sub4" class="code">function obj = setGeometry(obj, geometry)</a></li>
<li><a href="#_sub5" class="code">function obj = setModelType(obj, modelType)</a></li>
<li><a href="#_sub6" class="code">function names = getAllAllowedNames(obj)</a></li>
<li><a href="#_sub7" class="code">function obj = addParameterGroup(obj, paramGroup)</a></li>
<li><a href="#_sub8" class="code">function obj = addParameter(obj, varargin)</a></li>
<li><a href="#_sub9" class="code">function obj = removeParameter(obj, row)</a></li>
<li><a href="#_sub10" class="code">function obj = setParameter(obj, row, varargin)</a></li>
<li><a href="#_sub11" class="code">function obj = setParameterValue(obj, row, value)</a></li>
<li><a href="#_sub12" class="code">function obj = setParameterConstraint(obj, row, min, max)</a></li>
<li><a href="#_sub13" class="code">function obj = setParameterName(obj, row, name)</a></li>
<li><a href="#_sub14" class="code">function obj = setParameterFit(obj, row, fitFlag)</a></li>
<li><a href="#_sub15" class="code">function obj = setParameterPrior(obj, row, varargin)</a></li>
<li><a href="#_sub16" class="code">function obj = addLayerGroup(obj, layerGroup)</a></li>
<li><a href="#_sub17" class="code">function obj = addLayer(obj, varargin)</a></li>
<li><a href="#_sub18" class="code">function obj = removeLayer(obj, layer)</a></li>
<li><a href="#_sub19" class="code">function obj = setLayerValue(obj, row, col, value)</a></li>
<li><a href="#_sub20" class="code">function obj = addBacksPar(obj, varargin)</a></li>
<li><a href="#_sub21" class="code">function obj = removeBacksPar(obj, varargin)</a></li>
<li><a href="#_sub22" class="code">function obj = setBacksParValue(obj, row, value)</a></li>
<li><a href="#_sub23" class="code">function obj = setBacksParConstr(obj, row, min, max)</a></li>
<li><a href="#_sub24" class="code">function obj = setBacksParName(obj, row, name)</a></li>
<li><a href="#_sub25" class="code">function obj = addBackground(obj, varargin)</a></li>
<li><a href="#_sub26" class="code">function obj = removeBackground(obj, row)</a></li>
<li><a href="#_sub27" class="code">function obj = setBackground(obj, row, varargin)</a></li>
<li><a href="#_sub28" class="code">function obj = setBackgroundName(obj, row, name)</a></li>
<li><a href="#_sub29" class="code">function obj = setBacksPar(obj, varargin)</a></li>
<li><a href="#_sub30" class="code">function obj = setResolParValue(obj, row, value)</a></li>
<li><a href="#_sub31" class="code">function obj = addResolPar(obj, varargin)</a></li>
<li><a href="#_sub32" class="code">function obj = setResolPar(obj, varargin)</a></li>
<li><a href="#_sub33" class="code">function obj = removeResolPar(obj, varargin)</a></li>
<li><a href="#_sub34" class="code">function obj = addResolution(obj, varargin)</a></li>
<li><a href="#_sub35" class="code">function obj = removeResolution(obj, row)</a></li>
<li><a href="#_sub36" class="code">function obj = addData(obj, varargin)</a></li>
<li><a href="#_sub37" class="code">function obj = removeData(obj, row)</a></li>
<li><a href="#_sub38" class="code">function obj = setData(obj, varargin)</a></li>
<li><a href="#_sub39" class="code">function obj = addBulkOut(obj, varargin)</a></li>
<li><a href="#_sub40" class="code">function obj = removeBulkOut(obj, varargin)</a></li>
<li><a href="#_sub41" class="code">function obj = setBulkOut(obj, varargin)</a></li>
<li><a href="#_sub42" class="code">function obj = addBulkIn(obj, varargin)</a></li>
<li><a href="#_sub43" class="code">function obj = removeBulkIn(obj, varargin)</a></li>
<li><a href="#_sub44" class="code">function obj = setBulkIn(obj, varargin)</a></li>
<li><a href="#_sub45" class="code">function obj = addScalefactor(obj, varargin)</a></li>
<li><a href="#_sub46" class="code">function obj = removeScalefactor(obj, varargin)</a></li>
<li><a href="#_sub47" class="code">function obj = setScalefactor(obj, varargin)</a></li>
<li><a href="#_sub48" class="code">function obj = addQzshift(obj, varargin)</a></li>
<li><a href="#_sub49" class="code">function obj = addCustomFile(obj, varargin)</a></li>
<li><a href="#_sub50" class="code">function obj = removeCustomFile(obj, row)</a></li>
<li><a href="#_sub51" class="code">function obj = setCustomFile(obj, row, varargin)</a></li>
<li><a href="#_sub52" class="code">function obj = addContrast(obj, varargin)</a></li>
<li><a href="#_sub53" class="code">function obj = removeContrast(obj, row)</a></li>
<li><a href="#_sub54" class="code">function obj = setContrast(obj, row, varargin)</a></li>
<li><a href="#_sub55" class="code">function obj = setContrastModel(obj, row, model)</a></li>
<li><a href="#_sub56" class="code">function outStruct = toStruct(obj)</a></li>
<li><a href="#_sub57" class="code">function group = getPropertyGroup1(obj)</a></li>
<li><a href="#_sub58" class="code">function displayScalarObject(obj)</a></li>
<li><a href="#_sub59" class="code">function modifyLayersTable(obj,~,~)</a></li>
<li><a href="#_sub60" class="code">function domainsObj = domainsClass(obj)</a></li>
</ul>


<h2><a name="_source"></a>SOURCE CODE <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
<div class="fragment"><pre>0001 classdef <a href="projectClass.html" class="code" title="">projectClass</a> &lt; handle &amp; matlab.mixin.CustomDisplay
0002     
0003     <span class="comment">% Class definition for Standard Layers with no absorption.</span>
0004     <span class="comment">% Layers defined in terms of thickness, roughness, real SLD and</span>
0005     <span class="comment">% hydration.</span>
0006     <span class="comment">%</span>
0007     <span class="comment">% Sub objects used are:</span>
0008     <span class="comment">% parametersClass      - parameter definition with priors</span>
0009     <span class="comment">% layersClass          - layers defined as (d,rho_real,rough,hydration)</span>
0010     <span class="comment">% backgroundsClass     -</span>
0011     <span class="comment">% resolutionsClass     -</span>
0012     <span class="comment">% dataClass            -</span>
0013     <span class="comment">% contrastsClass       -</span>
0014     <span class="comment">% customFileClass      -</span>
0015     
0016     properties
0017         experimentName
0018         geometry
0019         parameters          <span class="comment">% parametersClass object</span>
0020         layers              <span class="comment">% layersClass object</span>
0021         bulkIn              <span class="comment">% parametersClass object</span>
0022         bulkOut             <span class="comment">% parametersClass object</span>
0023         background          <span class="comment">% backgroundsClass object</span>
0024         scalefactors        <span class="comment">% parametersClass object</span>
0025         qzshifts            <span class="comment">% parametersClass object</span>
0026         resolution          <span class="comment">% resolutionClass object</span>
0027         contrasts           <span class="comment">% contrastsClass object</span>
0028         data                <span class="comment">% dataClass object</span>
0029         customFile          <span class="comment">% Custom file object</span>
0030 
0031         modelType = modelTypes.StandardLayers.value
0032         usePriors = false
0033     <span class="keyword">end</span>
0034 
0035     properties (SetObservable, AbortSet)
0036         absorption {mustBeA(absorption,<span class="string">'logical'</span>)} = false
0037     <span class="keyword">end</span>
0038 
0039     properties (SetAccess = immutable)
0040         calculationType
0041         protectedParameters
0042     <span class="keyword">end</span>
0043 
0044     methods
0045 
0046         <a name="_sub0" href="#_subfunctions" class="code">function obj = projectClass(experimentName, calculationType, geometry, absorption)</a>
0047             <span class="comment">% Creates a Project object. The input arguments are the</span>
0048             <span class="comment">% experiment name which is a char array; the calculation type,</span>
0049             <span class="comment">% which is a calculationTypes enum; the geometry, which is a</span>
0050             <span class="comment">% geometryOptions enum; and a logical to state whether or not</span>
0051             <span class="comment">% absorption terms are included in the refractive index.</span>
0052             <span class="comment">% All of the arguments are optional.</span>
0053             <span class="comment">%</span>
0054             <span class="comment">% problem = projectClass('New experiment');</span>
0055             arguments
0056                 experimentName {mustBeTextScalar} = <span class="string">''</span>
0057                 calculationType = calculationTypes.NonPolarised
0058                 geometry = geometryOptions.AirSubstrate
0059                 absorption {mustBeA(absorption,<span class="string">'logical'</span>)} = false
0060             <span class="keyword">end</span>
0061 
0062             invalidTypeMessage = sprintf(<span class="string">'calculationType must be a calculationTypes enum or one of the following strings (%s)'</span>, <span class="keyword">...</span>
0063                                  strjoin(calculationTypes.values(), <span class="string">', '</span>));
0064 
0065             obj.calculationType = validateOption(calculationType, <span class="string">'calculationTypes'</span>, invalidTypeMessage).value;
0066 
0067             invalidGeometryMessage = sprintf(<span class="string">'geometry must be a geometryOptions enum or one of the following strings (%s)'</span>, <span class="keyword">...</span>
0068                                      strjoin(geometryOptions.values(), <span class="string">', '</span>));
0069 
0070             obj.geometry = validateOption(geometry, <span class="string">'geometryOptions'</span>, invalidGeometryMessage).value;
0071 
0072             obj.experimentName = experimentName;
0073 
0074             <span class="comment">% Initialise the Parameters Table</span>
0075             obj.parameters = <a href="parametersClass.html" class="code" title="">parametersClass</a>(<span class="string">'Substrate Roughness'</span>,1,3,5,true,priorTypes.Uniform,0,Inf);
0076 
0077             <span class="keyword">if</span> isequal(calculationType, calculationTypes.OilWater.value)
0078                 obj.addParameter(<span class="string">'Oil Thickness'</span>);
0079                 obj.addParameter(<span class="string">'Oil Roughness'</span>);
0080             <span class="keyword">end</span>
0081             
0082             obj.protectedParameters = cellstr(obj.parameters.getNames');
0083 
0084             <span class="comment">% Initialise the layers table. Then set the value of</span>
0085             <span class="comment">% absorption, listen for any changes, and modify the layers</span>
0086             <span class="comment">% table accordingly</span>
0087             addlistener(obj, <span class="string">'absorption'</span>, <span class="string">'PostSet'</span>, @obj.modifyLayersTable);
0088             obj.layers = <a href="layersClass.html" class="code" title="">layersClass</a>();
0089             obj.absorption = absorption;
0090             
0091             <span class="comment">% Initialise bulkIn table</span>
0092             obj.bulkIn = <a href="parametersClass.html" class="code" title="">parametersClass</a>(<span class="string">'SLD Air'</span>,0,0,0,false,priorTypes.Uniform,0,Inf);
0093             
0094             <span class="comment">% Initialise bulkOut table</span>
0095             obj.bulkOut = <a href="parametersClass.html" class="code" title="">parametersClass</a>(<span class="string">'SLD D2O'</span>,6.2e-6,6.35e-6,6.35e-6,false,priorTypes.Uniform,0,Inf);
0096             
0097             <span class="comment">% Initialise scalefactors table</span>
0098             obj.scalefactors = <a href="parametersClass.html" class="code" title="">parametersClass</a>(<span class="string">'Scalefactor 1'</span>,0.02,0.23,0.25,false,priorTypes.Uniform,0,Inf);
0099             
0100             <span class="comment">% Initialise qzshifts table</span>
0101             obj.qzshifts = <a href="parametersClass.html" class="code" title="">parametersClass</a>(<span class="string">'Qz shift 1'</span>,-1e-4,0,1e-4,false,priorTypes.Uniform,0,Inf);
0102             
0103             <span class="comment">% Initialise backs object</span>
0104             backPars = <a href="parametersClass.html" class="code" title="">parametersClass</a>(<span class="string">'Backs par 1'</span>,1e-7,1e-6,1e-5,false,priorTypes.Uniform,0,Inf);
0105             backgrounds = {<span class="string">'Background 1'</span>,allowedTypes.Constant.value,<span class="string">'Backs Par 1'</span>,<span class="string">''</span>,<span class="string">''</span>,<span class="string">''</span>,<span class="string">''</span>};
0106             obj.background = <a href="backgroundsClass.html" class="code" title="">backgroundsClass</a>(backPars, backgrounds);
0107             
0108             <span class="comment">% Initialise resolution object</span>
0109             resolPars = <a href="parametersClass.html" class="code" title="">parametersClass</a>(<span class="string">'Resolution par 1'</span>,0.01,0.03,0.05,false,priorTypes.Uniform,0,Inf);
0110             resolutions = {<span class="string">'Resolution 1'</span>,allowedTypes.Constant.value,<span class="string">'Resolution par 1'</span>,<span class="string">''</span>,<span class="string">''</span>,<span class="string">''</span>,<span class="string">''</span>};
0111             obj.resolution = <a href="resolutionsClass.html" class="code" title="">resolutionsClass</a>(resolPars, resolutions);
0112             
0113             <span class="comment">% Initialise data object</span>
0114             obj.data = <a href="dataClass.html" class="code" title="">dataClass</a>(<span class="string">'Simulation'</span>, [], [], []);
0115 
0116             <span class="comment">% Initialise custom file object</span>
0117             obj.customFile = <a href="customFileClass.html" class="code" title="">customFileClass</a>();
0118 
0119             <span class="comment">% Initialise contrasts object</span>
0120             obj.contrasts = <a href="contrastsClass.html" class="code" title="">contrastsClass</a>();               
0121         <span class="keyword">end</span>
0122         
0123         <a name="_sub1" href="#_subfunctions" class="code">function domainsObj = toDomainsClass(obj)</a>
0124             <span class="comment">% Alias of the converter routine from projectClass to</span>
0125             <span class="comment">% domainsClass.</span>
0126             <span class="comment">% This routine takes the currently defined project and</span>
0127             <span class="comment">% converts it to a domains calculation, preserving all</span>
0128             <span class="comment">% currently defined properties.</span>
0129             <span class="comment">%</span>
0130             <span class="comment">% domainsProblem = problem.toDomainsClass();</span>
0131             domainsObj = obj.domainsClass();
0132         <span class="keyword">end</span>
0133 
0134         <a name="_sub2" href="#_subfunctions" class="code">function obj = setUsePriors(obj, showFlag)</a>
0135             <span class="comment">% Sets the use priors flag. The showFlag should be a boolean/logical.</span>
0136             <span class="comment">%</span>
0137             <span class="comment">% problem.setUsePriors(true);</span>
0138             <span class="keyword">if</span> ~islogical(showFlag)
0139                 throw(invalidType(<span class="string">'usePriors must be logical ''true'' or ''false'''</span>));
0140             <span class="keyword">end</span>
0141             obj.usePriors = showFlag;
0142             
0143             <span class="comment">% Also need to set the flag in sub-objects</span>
0144             <span class="comment">% where relevant..</span>
0145             <span class="comment">% (1) Parameters</span>
0146             <span class="comment">% replace with showFlag</span>
0147             obj.parameters.showPriors = showFlag;
0148             
0149             <span class="comment">% (2) Bulk In</span>
0150             obj.bulkIn.showPriors = showFlag;
0151             
0152             <span class="comment">% (3) Bulk out</span>
0153             obj.bulkOut.showPriors = showFlag;
0154             
0155             <span class="comment">% (4) Scalefactors</span>
0156             obj.scalefactors.showPriors = showFlag;
0157             
0158             <span class="comment">% (5) Qz shifts</span>
0159             obj.qzshifts.showPriors = showFlag;
0160             
0161             <span class="comment">% (6) Backgrounds (parameters table)</span>
0162             obj.background.backPars.showPriors = showFlag;
0163             
0164             <span class="comment">% (7) Resolutions (parameters table)</span>
0165             obj.resolution.resolPars.showPriors = showFlag;
0166             
0167         <span class="keyword">end</span>
0168         
0169         <a name="_sub3" href="#_subfunctions" class="code">function obj = setGeometry(obj, geometry)</a>
0170             <span class="comment">% Sets the experiment geometry. The geometry should be a string,</span>
0171             <span class="comment">% either &quot;Air/Substrate&quot; or &quot;Substrate/Liquid&quot; is permitted.</span>
0172             <span class="comment">%</span>
0173             <span class="comment">% problem.setGeometry('Substrate/liquid');</span>
0174             invalidTypeMessage = sprintf(<span class="string">'Geometry must be a geometryOptions enum or one of the following strings (%s)'</span>, <span class="keyword">...</span>
0175                                          strjoin(geometryOptions.values(), <span class="string">', '</span>));
0176             obj.geometry = validateOption(geometry, <span class="string">'geometryOptions'</span>, invalidTypeMessage).value;
0177         <span class="keyword">end</span>
0178         
0179         <a name="_sub4" href="#_subfunctions" class="code">function obj = setModelType(obj, modelType)</a>
0180             <span class="comment">% Sets the experiment type. The type should be a string,</span>
0181             <span class="comment">% either &quot;standard layers&quot;, &quot;custom layers&quot;, or &quot;custom xy&quot; is permitted.</span>
0182             <span class="comment">%</span>
0183             <span class="comment">% problem.setModelType('Custom Layers');</span>
0184             invalidTypeMessage = sprintf(<span class="string">'Experiment type must be a modelTypes enum or one of the following strings (%s)'</span>, <span class="keyword">...</span>
0185                                          strjoin(modelTypes.values(), <span class="string">', '</span>));
0186             obj.modelType = validateOption(modelType, <span class="string">'modelTypes'</span>, invalidTypeMessage).value;
0187         <span class="keyword">end</span>
0188         
0189 
0190         <a name="_sub5" href="#_subfunctions" class="code">function names = getAllAllowedNames(obj)           </a>
0191             <span class="comment">% Returns a cell array of all currently</span>
0192             <span class="comment">% set parameter names for the project.</span>
0193             names.paramNames = obj.parameters.getNames();
0194             names.backsNames = obj.background.getBackgroundNames();
0195             names.backParNames = obj.background.backPars.getNames();
0196             names.bulkInNames = obj.bulkIn.getNames();
0197             names.bulkOutNames = obj.bulkOut.getNames();
0198             names.resolsNames = obj.resolution.getResolNames();
0199             names.resolParNames = obj.resolution.resolPars.getNames();
0200             names.layersNames = obj.layers.getNames();
0201             names.dataNames = obj.data.getNames();
0202             names.scalefacNames = obj.scalefactors.getNames();
0203             names.qzShiftNames = obj.qzshifts.getNames();
0204             names.customNames = obj.customFile.getNames(); 
0205         <span class="keyword">end</span>
0206         
0207         <span class="comment">% ---------------------------------</span>
0208         <span class="comment">% Editing Parameters Block</span>
0209         
0210         <a name="_sub6" href="#_subfunctions" class="code">function obj = addParameterGroup(obj, paramGroup)</a>
0211             <span class="comment">% Adds a group of parameters to the parameters object.</span>
0212             <span class="comment">% Expects a cell array of parameter cell arrays.</span>
0213             <span class="comment">%</span>
0214             <span class="comment">% problem.addParameterGroup({{'Tails Thickness'}, {'Heads Thickness'}});</span>
0215             <span class="keyword">for</span> i = 1:length(paramGroup)
0216                 <span class="keyword">if</span> iscell(paramGroup{i})
0217                     obj = <a href="#_sub8" class="code" title="subfunction obj = addParameter(obj, varargin)">addParameter</a>(obj, paramGroup{i});
0218                 <span class="keyword">else</span>
0219                     throw(invalidType(<span class="string">'Expecting a cell array of parameters in ''addParameterGroup'''</span>));
0220                 <span class="keyword">end</span>
0221             <span class="keyword">end</span>
0222         <span class="keyword">end</span>
0223         
0224         
0225         <a name="_sub7" href="#_subfunctions" class="code">function obj = addParameter(obj, varargin)</a>
0226             <span class="comment">% Adds an individual parameter to the parameters object.</span>
0227             <span class="comment">% Check how many parameters we are adding and make sure all</span>
0228             <span class="comment">% the inputs are cells. A parameter consists of a name, min,</span>
0229             <span class="comment">% value, max, fit flag, prior type', mu, and sigma. The input</span>
0230             <span class="comment">% is optional but if provided should contain 1, 2, 4, 5, or 8</span>
0231             <span class="comment">% values of the parameter to added.</span>
0232             <span class="comment">%</span>
0233             <span class="comment">% problem.addParameter('Tails Roughness');</span>
0234             <span class="keyword">if</span> isempty(varargin)
0235                 obj.parameters.addParameter();
0236             <span class="keyword">else</span>
0237                 <span class="keyword">if</span> length(varargin) == 1 &amp;&amp; iscell(varargin{:})
0238                     params = varargin{:};
0239                 <span class="keyword">else</span>
0240                     params = varargin;
0241                 <span class="keyword">end</span>
0242                 obj.parameters.addParameter(params{:});
0243             <span class="keyword">end</span> 
0244         <span class="keyword">end</span>
0245                 
0246         <a name="_sub8" href="#_subfunctions" class="code">function obj = removeParameter(obj, row)</a>
0247             <span class="comment">% Removes a parameter from the parameters object. The</span>
0248             <span class="comment">% parameter will also be removed from the layers array</span>
0249             <span class="comment">% if it is in use. Expects series of indices or names of</span>
0250             <span class="comment">% parameters to remove</span>
0251             <span class="comment">%</span>
0252             <span class="comment">% problem.removeParameter(2);</span>
0253             <span class="keyword">if</span> isa(row, <span class="string">'double'</span>)
0254                 row = num2cell(sort(row, <span class="string">'descend'</span>));
0255             <span class="keyword">elseif</span> isText(row)
0256                 row = cellstr(row);
0257             <span class="keyword">elseif</span> iscell(row)
0258             <span class="keyword">else</span>
0259                 throw(invalidType(<span class="string">'Unrecognised Row'</span>))
0260             <span class="keyword">end</span>
0261 
0262             <span class="keyword">for</span> i = 1:length(row)
0263                 thisParam = row{i};
0264                 
0265                 <span class="comment">% Make sure we don't remove any protected parameters</span>
0266                 <span class="keyword">if</span> (isnumeric(thisParam) &amp;&amp; thisParam &lt;= length(obj.protectedParameters)) || any((strcmpi(thisParam, obj.protectedParameters)))
0267                     throw(invalidOption(sprintf(<span class="string">'Can''t remove protected parameters'</span>)));
0268                 <span class="keyword">end</span>
0269                 
0270                 <span class="comment">% No need to check validity of the parameter</span>
0271                 <span class="comment">% as this is done in the parameters class</span>
0272                 obj.parameters.removeParameter(thisParam);
0273                 
0274                 <span class="comment">% Need to check if it is used in the layers</span>
0275                 <span class="comment">% array and remove it if so. Should be able</span>
0276                 <span class="comment">% to do this with array indexing, but can't quite figure</span>
0277                 <span class="comment">% that out atm, so just use a (dirty) loop over all</span>
0278                 <span class="comment">% the elements for now..</span>
0279                 
0280                 findParam = string(thisParam);
0281                 laysTable = obj.layers.varTable;
0282                 dims = size(laysTable);
0283                 <span class="keyword">for</span> m = 1:dims(1)
0284                     <span class="keyword">for</span> n = 1:dims(2)
0285                         tablePar = laysTable{m,n};   <span class="comment">% Should be a string</span>
0286                         <span class="keyword">if</span> isequal(findParam, tablePar)
0287                             obj.layers.varTable(m,n) = {<span class="string">''</span>};
0288                         <span class="keyword">end</span>
0289                     <span class="keyword">end</span>
0290                 <span class="keyword">end</span>
0291             <span class="keyword">end</span>
0292             
0293         <span class="keyword">end</span>
0294         
0295         <a name="_sub9" href="#_subfunctions" class="code">function obj = setParameter(obj, row, varargin)</a>
0296             <span class="comment">% General purpose set parameter method. Expects</span>
0297             <span class="comment">% index or name of parameter and keyword/value pairs to set</span>
0298             <span class="comment">%</span>
0299             <span class="comment">% problem.setParameter(2, 'value', 50);</span>
0300             obj.parameters.setParameter(row, varargin{:});
0301         <span class="keyword">end</span>
0302         
0303         
0304         <a name="_sub10" href="#_subfunctions" class="code">function obj = setParameterValue(obj, row, value)</a>
0305             <span class="comment">% Sets the value of a given parameter. Expects</span>
0306             <span class="comment">% index or name of parameter and new value to set</span>
0307             <span class="comment">%</span>
0308             <span class="comment">% problem.setParameterValue(2, 50);</span>
0309             obj.parameters.setValue(row, value);
0310         <span class="keyword">end</span>
0311         
0312         <a name="_sub11" href="#_subfunctions" class="code">function obj = setParameterConstraint(obj, row, min, max)</a>
0313             <span class="comment">% Sets the constraints of an existing parameter.</span>
0314             <span class="comment">% Expects index or name of parameter and new min</span>
0315             <span class="comment">% and max of the parameter's value</span>
0316             <span class="comment">%</span>
0317             <span class="comment">% problem.setParameterConstraint(2, 0, 100);</span>
0318             obj.parameters.setConstraint(row, min, max);
0319         <span class="keyword">end</span>
0320         
0321         <a name="_sub12" href="#_subfunctions" class="code">function obj = setParameterName(obj, row, name)</a>
0322             <span class="comment">% Sets the name of an existing parameter</span>
0323             <span class="comment">% Expects index or name of parameter and the</span>
0324             <span class="comment">% new name</span>
0325             <span class="comment">%</span>
0326             <span class="comment">% problem.setParameterName(2, 'new name');</span>
0327             <span class="keyword">if</span> (isnumeric(row) &amp;&amp; row &lt;= length(obj.protectedParameters)) || any((strcmpi(row, obj.protectedParameters)))
0328                 throw(invalidOption(<span class="string">'Can''t rename protected parameters'</span>));
0329             <span class="keyword">end</span>
0330             obj.parameters.setName(row, name);
0331         <span class="keyword">end</span>
0332         
0333         <a name="_sub13" href="#_subfunctions" class="code">function obj = setParameterFit(obj, row, fitFlag)</a>
0334             <span class="comment">% Sets the 'fit' to off or on for parameter.</span>
0335             <span class="comment">% Expects index or name of parameter and</span>
0336             <span class="comment">% new fit flag</span>
0337             <span class="comment">%</span>
0338             <span class="comment">% problem.setParameterFit(2, true);</span>
0339             obj.parameters.setFit(row, fitFlag);
0340         <span class="keyword">end</span>
0341         
0342         <a name="_sub14" href="#_subfunctions" class="code">function obj = setParameterPrior(obj, row, varargin)</a>
0343             <span class="comment">% Sets the prior type of the parameter.</span>
0344             <span class="comment">% Expects index or name of parameter and</span>
0345             <span class="comment">% new prior type('uniform','gaussian','jeffreys')</span>
0346             <span class="comment">%</span>
0347             <span class="comment">% problem.setParameterPrior(2, 'uniform');</span>
0348             obj.parameters.setPrior(row, varargin{:});  
0349         <span class="keyword">end</span>
0350         
0351         <span class="comment">% -----------------------------------------------------</span>
0352         
0353         <span class="comment">% Editing of layers block</span>
0354         <a name="_sub15" href="#_subfunctions" class="code">function obj = addLayerGroup(obj, layerGroup)</a>
0355             <span class="comment">% Adds a group of layers to the layers object. Expects</span>
0356             <span class="comment">% a cell array of layer cell arrays</span>
0357             <span class="comment">%</span>
0358             <span class="comment">% problem.addLayerGroup({{'Layer 1'}, {'Layer 2'}});</span>
0359             <span class="keyword">for</span> i = 1:length(layerGroup)
0360                 <span class="keyword">if</span> iscell(layerGroup{i})
0361                     obj = <a href="#_sub17" class="code" title="subfunction obj = addLayer(obj, varargin)">addLayer</a>(obj, layerGroup{i});
0362                 <span class="keyword">else</span>
0363                     throw(invalidType(<span class="string">'Expecting a cell array of parameters in ''addLayerGroup'''</span>));
0364                 <span class="keyword">end</span>
0365             <span class="keyword">end</span>  
0366         <span class="keyword">end</span>
0367         
0368         <a name="_sub16" href="#_subfunctions" class="code">function obj = addLayer(obj, varargin)</a>
0369             <span class="comment">% Adds a single layer to the layers object. Expects layer</span>
0370             <span class="comment">% details which are name, thickness, SLD, roughness,</span>
0371             <span class="comment">% hydration, and hydrate with, or provide with no details,</span>
0372             <span class="comment">% or just a name, to create an empty layer.</span>
0373             <span class="comment">%</span>
0374             <span class="comment">% problem.addLayer('New Layer');</span>
0375             <span class="keyword">if</span> isempty(varargin)
0376                 obj.layers.addLayer(obj.parameters.varTable{:,1});
0377             <span class="keyword">else</span>
0378                 <span class="comment">% If the input is wrapped in a cell (so varargin is a cell of a cell)</span>
0379                 <span class="comment">% need to unwrap one layer of it, otherwise keep varargin as it is</span>
0380                 <span class="keyword">if</span> length(varargin) == 1 &amp;&amp; iscell(varargin{:})
0381                     thisLayer = varargin{:};
0382                 <span class="keyword">else</span>
0383                     thisLayer = varargin;
0384                 <span class="keyword">end</span>
0385                 obj.layers.addLayer(obj.parameters.varTable{:,1}, thisLayer{:});
0386             <span class="keyword">end</span>
0387         <span class="keyword">end</span>
0388 
0389         <a name="_sub17" href="#_subfunctions" class="code">function obj = removeLayer(obj, layer)</a>
0390             <span class="comment">% Removes layer(s) from the layers object. Expects</span>
0391             <span class="comment">% index of layer(s) to remove.</span>
0392             <span class="comment">%</span>
0393             <span class="comment">% problem.removeLayer(1);</span>
0394             obj.layers.removeRow(layer);
0395         <span class="keyword">end</span>
0396 
0397         <a name="_sub18" href="#_subfunctions" class="code">function obj = setLayerValue(obj, row, col, value)</a>
0398             <span class="comment">% Sets a value of a given layer. Expects the row/name and</span>
0399             <span class="comment">% column of layer value to set, then the name/index of the</span>
0400             <span class="comment">% parameter to set the value to.</span>
0401             <span class="comment">%</span>
0402             <span class="comment">% problem.setLayerValue(1, 2, 'Tails Thickness');</span>
0403             obj.layers.setLayerValue(row, col, value, obj.parameters.varTable{:,1});           
0404         <span class="keyword">end</span>
0405         
0406         <span class="comment">% ---------------------------------------------------------------</span>
0407         
0408         <span class="comment">% Editing of Backgrounds block</span>
0409         
0410         
0411         <span class="comment">%(1) Background Parameters</span>
0412         <a name="_sub19" href="#_subfunctions" class="code">function obj = addBacksPar(obj, varargin)</a>
0413             <span class="comment">% Adds a new background parameter. A parameter consists</span>
0414             <span class="comment">% of a name, min, value, max, fit flag, prior type', mu,</span>
0415             <span class="comment">% and sigma</span>
0416             <span class="comment">%</span>
0417             <span class="comment">% problem.addBacksPar('Backs Value D2O', 1e-8, 2.8e-6, 1e-5);</span>
0418             obj.background.backPars.addParameter(varargin{:});
0419         <span class="keyword">end</span>
0420         
0421         <a name="_sub20" href="#_subfunctions" class="code">function obj = removeBacksPar(obj, varargin)</a>
0422             <span class="comment">% Removes a given background parameter.</span>
0423             <span class="comment">% Expects index or name of parameter to remove</span>
0424             <span class="comment">%</span>
0425             <span class="comment">% problem.removeBacksPar(2);</span>
0426             obj.background.backPars.removeParameter(varargin{:});
0427         <span class="keyword">end</span>
0428         
0429         <a name="_sub21" href="#_subfunctions" class="code">function obj = setBacksParValue(obj, row, value)</a>
0430             <span class="comment">% Sets the value of existing background</span>
0431             <span class="comment">% parameter. Expects index or name of parameter</span>
0432             <span class="comment">% and new value to set</span>
0433             <span class="comment">%</span>
0434             <span class="comment">% problem.setBacksParValue(1, 5.5e-6);</span>
0435             obj.background.backPars.setValue(row, value);
0436         <span class="keyword">end</span>
0437         
0438         <a name="_sub22" href="#_subfunctions" class="code">function obj = setBacksParConstr(obj, row, min, max)</a>
0439             <span class="comment">% Sets the constraints of existing background</span>
0440             <span class="comment">% parameter. Expects index or name of parameter</span>
0441             <span class="comment">% and new min and max of the parameter's value</span>
0442             <span class="comment">%</span>
0443             <span class="comment">% problem.setBacksParConstr(1, 0, 1);</span>
0444             obj.background.backPars.setConstraint(row, min, max);
0445         <span class="keyword">end</span>
0446         
0447         <a name="_sub23" href="#_subfunctions" class="code">function obj = setBacksParName(obj, row, name)</a>
0448             <span class="comment">% Sets the name of an existing background</span>
0449             <span class="comment">% parameter. Expects index or name of parameter</span>
0450             <span class="comment">% and the new name</span>
0451             <span class="comment">%</span>
0452             <span class="comment">% problem.setBacksParName(2, 'new name');</span>
0453             obj.background.backPars.setName(row, name);
0454         <span class="keyword">end</span>
0455         
0456         <span class="comment">% (2) Backgrounds</span>
0457         <a name="_sub24" href="#_subfunctions" class="code">function obj = addBackground(obj, varargin)</a>
0458             <span class="comment">% Adds a background to the project. Expects a</span>
0459             <span class="comment">% cell array with background name and type and</span>
0460             <span class="comment">% up to 4 parameters</span>
0461             <span class="comment">%</span>
0462             <span class="comment">% problem.addBackground('name', 'constant', 'par');</span>
0463             obj.background.addBackground(varargin{:});
0464         <span class="keyword">end</span>
0465         
0466         <a name="_sub25" href="#_subfunctions" class="code">function obj = removeBackground(obj, row)</a>
0467             <span class="comment">% Removes background from the project. Expects</span>
0468             <span class="comment">% index or array of indices of background(s) of background(s)</span>
0469             <span class="comment">% to remove</span>
0470             <span class="comment">%</span>
0471             <span class="comment">% problem.removeBackground(1);</span>
0472             obj.background.removeBackground(row);
0473         <span class="keyword">end</span>
0474         
0475         <a name="_sub26" href="#_subfunctions" class="code">function obj = setBackground(obj, row, varargin)</a>
0476             <span class="comment">% Sets the value of an existing background. Expects</span>
0477             <span class="comment">% index or name of background and keyword/value pairs to set</span>
0478             <span class="comment">%</span>
0479             <span class="comment">% problem.setBackground(1, 'name', 'Background ACMW');</span>
0480             obj.background.setBackground(row, varargin{:});
0481         <span class="keyword">end</span>
0482         
0483         <a name="_sub27" href="#_subfunctions" class="code">function obj = setBackgroundName(obj, row, name)</a>
0484             <span class="comment">% Sets the name of an existing Background.</span>
0485             <span class="comment">% Expects index or name of background and the new name</span>
0486             <span class="comment">%</span>
0487             <span class="comment">% problem.setBackgroundName(2, 'new name');</span>
0488             obj.background.setBackgroundName(row, name);
0489         <span class="keyword">end</span>
0490         
0491         <a name="_sub28" href="#_subfunctions" class="code">function obj = setBacksPar(obj, varargin)</a>
0492             <span class="comment">% Sets the value of an existing background parameter. Expects</span>
0493             <span class="comment">% index or name of parameter and keyword/value pairs to set</span>
0494             <span class="comment">%</span>
0495             <span class="comment">% problem.setBacksPar(1, 'name', 'Backs Value H2O');</span>
0496             obj.background.backPars.setParameter(varargin{:});
0497         <span class="keyword">end</span>
0498         
0499         <span class="comment">% -------------------------------------------------------------</span>
0500         <span class="comment">%   Editing of Resolutions block</span>
0501         
0502         <span class="comment">% Resol Pars</span>
0503         <a name="_sub29" href="#_subfunctions" class="code">function obj = setResolParValue(obj, row, value)</a>
0504             <span class="comment">% Sets the value of existing resolution</span>
0505             <span class="comment">% parameter. Expects index or name of parameter</span>
0506             <span class="comment">% and new value to set</span>
0507             <span class="comment">%</span>
0508             <span class="comment">% problem.setResolParValue(1, 5.5e-6);</span>
0509             obj.resolution.resolPars.setValue(row, value);
0510         <span class="keyword">end</span>
0511         
0512         <a name="_sub30" href="#_subfunctions" class="code">function obj = addResolPar(obj, varargin)</a>
0513             <span class="comment">% Adds a new resolution parameter. A parameter consists</span>
0514             <span class="comment">% of a name, min, value, max, fit flag, prior type', mu,</span>
0515             <span class="comment">% and sigma</span>
0516             <span class="comment">%</span>
0517             <span class="comment">% problem.addResolPar('ResolPar 1', 1e-8, 2.8e-6, 1e-5);</span>
0518             obj.resolution.resolPars.addParameter(varargin{:});
0519         <span class="keyword">end</span>
0520         
0521         <a name="_sub31" href="#_subfunctions" class="code">function obj = setResolPar(obj, varargin)</a>
0522             <span class="comment">% Sets the value of an existing resolution parameter. Expects</span>
0523             <span class="comment">% index or name of parameter and keyword/value pairs to set</span>
0524             <span class="comment">%</span>
0525             <span class="comment">% problem.setResolPar(1, 'name', 'ResolPar');</span>
0526             obj.resolution.resolPars.setParameter(varargin{:});
0527         <span class="keyword">end</span>
0528         
0529         <a name="_sub32" href="#_subfunctions" class="code">function obj = removeResolPar(obj, varargin)</a>
0530             <span class="comment">% Removes a given resolution parameter.</span>
0531             <span class="comment">% Expects index or name of parameter to remove</span>
0532             <span class="comment">%</span>
0533             <span class="comment">% problem.removeResolPar(2);</span>
0534             obj.resolution.resolPars.removeParameter(varargin{:});
0535         <span class="keyword">end</span>
0536         
0537         <span class="comment">% Resolutions</span>
0538         <a name="_sub33" href="#_subfunctions" class="code">function obj = addResolution(obj, varargin)</a>
0539             <span class="comment">% Adds a resolution to the project. Expects a</span>
0540             <span class="comment">% cell array with resolution name and type and</span>
0541             <span class="comment">% up to 4 parameters</span>
0542             <span class="comment">%</span>
0543             <span class="comment">% problem.addResolution('name','constant','par');</span>
0544             obj.resolution.addResolution(varargin{:});
0545         <span class="keyword">end</span>
0546         
0547         <a name="_sub34" href="#_subfunctions" class="code">function obj = removeResolution(obj, row)</a>
0548             <span class="comment">% Removes resolution from the project. Expects</span>
0549             <span class="comment">% index of resolution to remove</span>
0550             <span class="comment">%</span>
0551             <span class="comment">% problem.removeResolution(1);</span>
0552             obj.resolution.removeResolution(row);
0553         <span class="keyword">end</span>
0554         
0555         
0556         <span class="comment">% ------------------------------------------------------------</span>
0557         <span class="comment">%   Editing of Data block</span>
0558         
0559         <a name="_sub35" href="#_subfunctions" class="code">function obj = addData(obj, varargin)</a>
0560             <span class="comment">% Adds a new data parameter. Expects the name</span>
0561             <span class="comment">% of data and the data array</span>
0562             <span class="comment">%</span>
0563             <span class="comment">% problem.addData('Sim 2', data);</span>
0564             obj.data.addData(varargin{:});
0565         <span class="keyword">end</span>
0566         
0567         <a name="_sub36" href="#_subfunctions" class="code">function obj = removeData(obj, row)</a>
0568             <span class="comment">% Removes a dataset. Expects the index or array of</span>
0569             <span class="comment">% indices of dataset(s) to remove.</span>
0570             <span class="comment">%</span>
0571             <span class="comment">% problem.removeData(2);</span>
0572             obj.data.removeRow(row);
0573         <span class="keyword">end</span>
0574         
0575         <a name="_sub37" href="#_subfunctions" class="code">function obj = setData(obj, varargin)</a>
0576             <span class="comment">% Edits an existing data parameter. Expects the</span>
0577             <span class="comment">% index of data to edit and key-value pairs</span>
0578             <span class="comment">%</span>
0579             <span class="comment">% problem.setData(1, 'name', 'Sim 1', 'data', zeros(4, 3));</span>
0580             nameChanged = obj.data.setData(varargin{:});
0581             
0582             <span class="keyword">if</span> ~isempty(nameChanged)
0583                 obj.contrasts.updateDataName(nameChanged);
0584             <span class="keyword">end</span>
0585         <span class="keyword">end</span>
0586         
0587         
0588         <span class="comment">% ---------------------------------------------------------------</span>
0589         <span class="comment">%   Editing of Bulk out block</span>
0590         
0591         <a name="_sub38" href="#_subfunctions" class="code">function obj = addBulkOut(obj, varargin)</a>
0592             <span class="comment">% Adds a new bulk-out parameter. Expects the name</span>
0593             <span class="comment">% of bulk-out, min, value, max, and if fit is off or on</span>
0594             <span class="comment">%</span>
0595             <span class="comment">% problem.addBulkOut('SLD ACMW', -1e-6, 0.0, 1e-6, true);</span>
0596             obj.bulkOut.addParameter(varargin{:});
0597         <span class="keyword">end</span>
0598         
0599         <a name="_sub39" href="#_subfunctions" class="code">function obj = removeBulkOut(obj, varargin)</a>
0600             <span class="comment">% Removes specified bulk-out parameter. Expects the name/index</span>
0601             <span class="comment">% of bulk-out to remove</span>
0602             <span class="comment">%</span>
0603             <span class="comment">% problem.removeBulkOut(2);</span>
0604             obj.bulkOut.removeParameter(varargin{:});
0605         <span class="keyword">end</span>
0606         
0607         <a name="_sub40" href="#_subfunctions" class="code">function obj = setBulkOut(obj, varargin)</a>
0608             <span class="comment">% Edits an existing bulk-out parameter. Expects the</span>
0609             <span class="comment">% index of bulk-out to edit and key-value pairs</span>
0610             <span class="comment">%</span>
0611             <span class="comment">% problem.setBulkOut(1, 'name', 'SLD H2O', 'min', 2.07e-6);</span>
0612             obj.bulkOut.setParameter(varargin{:});
0613         <span class="keyword">end</span>
0614         
0615         
0616         <span class="comment">% ------------------------------------------------------------------</span>
0617         <span class="comment">% Editing of bulk in block</span>
0618         
0619         <a name="_sub41" href="#_subfunctions" class="code">function obj = addBulkIn(obj, varargin)</a>
0620             <span class="comment">% Adds a new bulk-in parameter. Expects the name</span>
0621             <span class="comment">% of bulk-in, min, value, max, and if fit is off or on</span>
0622             <span class="comment">%</span>
0623             <span class="comment">% problem.addBulkIn('Silicon', -1e-6, 0.0, 1e-6, true);</span>
0624             obj.bulkIn.addParameter(varargin{:});
0625         <span class="keyword">end</span>
0626         
0627         <a name="_sub42" href="#_subfunctions" class="code">function obj = removeBulkIn(obj, varargin)</a>
0628             <span class="comment">% Removes specified bulk-in parameter. Expects the name/index</span>
0629             <span class="comment">% of bulk-in to remove</span>
0630             <span class="comment">%</span>
0631             <span class="comment">% problem.removeBulkIn(2);</span>
0632             obj.bulkIn.removeParameter(varargin{:});
0633         <span class="keyword">end</span>
0634         
0635         <a name="_sub43" href="#_subfunctions" class="code">function obj = setBulkIn(obj, varargin)</a>
0636             <span class="comment">% Edits an existing bulk-in parameter. Expects the</span>
0637             <span class="comment">% index of bulk-in to edit and key-value pairs</span>
0638             <span class="comment">%</span>
0639             <span class="comment">% problem.setBulkIn(1, 'name', 'Silicon', 'max', 2.07e-6);</span>
0640             obj.bulkIn.setParameter(varargin{:});
0641         <span class="keyword">end</span>
0642         
0643         <span class="comment">% -------------------------------------------------------------------</span>
0644         <span class="comment">% Editing of scalefactors block</span>
0645         
0646         <a name="_sub44" href="#_subfunctions" class="code">function obj = addScalefactor(obj, varargin)</a>
0647             <span class="comment">% Adds a new scale factor parameter. Expects the name</span>
0648             <span class="comment">% of scale factor, min, value, max, and if fit is off or on</span>
0649             <span class="comment">%</span>
0650             <span class="comment">% problem.addScalefactor('Scalefactor 2', 0.1, 0.19, 1.0, true);</span>
0651             obj.scalefactors.addParameter(varargin{:});
0652         <span class="keyword">end</span>
0653         
0654         <a name="_sub45" href="#_subfunctions" class="code">function obj = removeScalefactor(obj, varargin)</a>
0655             <span class="comment">% Removes specified scale factor parameter. Expects the name/index</span>
0656             <span class="comment">% of scale factor to remove</span>
0657             <span class="comment">%</span>
0658             <span class="comment">% problem.removeScalefactor(2);</span>
0659            obj.scalefactors.removeParameter(varargin{:}); 
0660         <span class="keyword">end</span>
0661         
0662         <a name="_sub46" href="#_subfunctions" class="code">function obj = setScalefactor(obj, varargin)</a>
0663             <span class="comment">% Edits an existing scale factor parameter. Expects the</span>
0664             <span class="comment">% index of scale factor to edit and key-value pairs</span>
0665             <span class="comment">%</span>
0666             <span class="comment">% problem.setScalefactor(1, 'name','Scalefactor 1', 'value', 0.23251);</span>
0667             obj.scalefactors.setParameter(varargin{:});
0668         <span class="keyword">end</span>
0669         
0670 
0671         <span class="comment">% -----------------------------------------------------------------</span>
0672         <span class="comment">% Editing of qzshifts block</span>
0673         
0674         <a name="_sub47" href="#_subfunctions" class="code">function obj = addQzshift(obj, varargin)</a>
0675             <span class="comment">% Adds a new qz shift parameter. Expects the name</span>
0676             <span class="comment">% of qz shift, min, value, max, and if fit is off or on</span>
0677             <span class="comment">%</span>
0678             <span class="comment">% problem..addQzshift('Qz shift 2', -0.2e-4, 0, 2e-4, false);</span>
0679             obj.qzshifts.addParameter(varargin{:}); 
0680         <span class="keyword">end</span>
0681         
0682         
0683         <span class="comment">% -----------------------------------------------------------------</span>
0684         <span class="comment">% editing of custom models block</span>
0685         
0686         <a name="_sub48" href="#_subfunctions" class="code">function obj = addCustomFile(obj, varargin)            </a>
0687             <span class="comment">% Adds a new custom file parameter. Expects a parameter name, filename,</span>
0688             <span class="comment">% language (matlab, octave, or cpp), and working directory</span>
0689             <span class="comment">%</span>
0690             <span class="comment">% problem.addCustomFile('model 1', 'custom.m', 'matlab', 'pwd');</span>
0691             obj.customFile.addCustomFile(varargin{:});
0692         <span class="keyword">end</span>
0693 
0694         <a name="_sub49" href="#_subfunctions" class="code">function obj = removeCustomFile(obj, row)</a>
0695             <span class="comment">% Removes custom file entry(ies) from the custom files object.</span>
0696             <span class="comment">% Expects index of entry(ies) to remove.</span>
0697             <span class="comment">%</span>
0698             <span class="comment">% problem.removeCustomFile(1);</span>
0699             obj.customFile.removeRow(row);
0700         <span class="keyword">end</span>
0701 
0702         <a name="_sub50" href="#_subfunctions" class="code">function obj = setCustomFile(obj, row, varargin)</a>
0703             <span class="comment">% Edits an existing custom file parameter. Expects the</span>
0704             <span class="comment">% index of custom file to edit and key-value pairs</span>
0705             <span class="comment">%</span>
0706             <span class="comment">% problem.setCustomFile(2, 'filename', 'custom.cpp');</span>
0707             obj.customFile.setCustomFile(row, varargin{:});
0708         <span class="keyword">end</span>
0709         
0710         
0711         <span class="comment">% ----------------------------------------------------------------</span>
0712         <span class="comment">%</span>
0713         <span class="comment">%   Editing of Contrasts Block</span>
0714         
0715         <a name="_sub51" href="#_subfunctions" class="code">function obj = addContrast(obj, varargin)</a>
0716             <span class="comment">% Adds a new contrast parameter. Expects a parameter name, and with</span>
0717             <span class="comment">% key-value pairs with one or more of the following &quot;data&quot;,</span>
0718             <span class="comment">% &quot;background&quot;, &quot;bulk in&quot;, &quot;bulk out&quot;, &quot;scalefactor&quot;,</span>
0719             <span class="comment">% &quot;resolution&quot;, &quot;resample&quot;, &quot;model&quot;</span>
0720             <span class="comment">%</span>
0721             <span class="comment">% problem.addContrast('contrast 1', 'nba', 'Silicon');</span>
0722             allowedNames = obj.getAllAllowedNames();
0723             obj.contrasts.addContrast(allowedNames, varargin{:});   
0724         <span class="keyword">end</span>
0725 
0726         <a name="_sub52" href="#_subfunctions" class="code">function obj = removeContrast(obj, row)</a>
0727             <span class="comment">% Removes a specified contrast parameter. Expects</span>
0728             <span class="comment">% index or name of resolution to remove</span>
0729             <span class="comment">%</span>
0730             <span class="comment">% problem.removeContrast(1);</span>
0731             obj.contrasts.removeContrast(row);
0732         <span class="keyword">end</span>
0733 
0734         <a name="_sub53" href="#_subfunctions" class="code">function obj = setContrast(obj, row, varargin)   </a>
0735             <span class="comment">% Allow setting of all parameters in terms of name value pairs.</span>
0736             <span class="comment">% First input must be contrast number or name, subsequent</span>
0737             <span class="comment">% inputs are name / value pairs for the parts involved</span>
0738             <span class="comment">%</span>
0739             <span class="comment">% problem.setContrast(1, 'name', 'contrast')</span>
0740                         
0741             <span class="comment">% Get the list of allowed values depending on what is</span>
0742             <span class="comment">% set for the other contrasts.</span>
0743             allowedValues = obj.getAllAllowedNames;
0744             
0745             <span class="comment">% Call the setContrast method</span>
0746             obj.contrasts.setContrast(row, allowedValues, varargin{:});
0747         <span class="keyword">end</span>
0748         
0749         <a name="_sub54" href="#_subfunctions" class="code">function obj = setContrastModel(obj, row, model)</a>
0750             <span class="comment">% Edits the model of an existing contrast parameter. Expects</span>
0751             <span class="comment">% the index of contrast parameter and cell array of layer names</span>
0752             <span class="comment">%</span>
0753             <span class="comment">% problem.setContrastModel(1, {'layer 1'})</span>
0754                         
0755             <span class="comment">% Make a different allowed list depending on whether</span>
0756             <span class="comment">% it is custom or layers</span>
0757             <span class="keyword">if</span> strcmpi(obj.modelType, modelTypes.StandardLayers.value)
0758                 <span class="comment">% Standard Layers</span>
0759                 allowedValues = obj.layers.getNames();
0760             <span class="keyword">else</span>
0761                 <span class="comment">% Custom models</span>
0762                 allowedValues = obj.customFile.getNames();
0763             <span class="keyword">end</span>
0764             
0765             <span class="comment">% Call the setContrastModel method</span>
0766             obj.contrasts.setContrastModel(row, obj.modelType, allowedValues, model);
0767         <span class="keyword">end</span>
0768 
0769         <span class="comment">% ----------------------------------------------------------------</span>
0770 
0771         <a name="_sub55" href="#_subfunctions" class="code">function outStruct = toStruct(obj)    </a>
0772             <span class="comment">% Converts the class parameters into a struct array for input</span>
0773             <span class="comment">% into the RAT toolbox</span>
0774             
0775             <span class="comment">% Set which type of experiment this is</span>
0776             generalStruct.experimentName = obj.experimentName;
0777             generalStruct.TF = obj.calculationType;
0778             
0779             <span class="comment">% Add the 'general' fields</span>
0780             generalStruct.modelType = lower(obj.modelType);  
0781             generalStruct.geometry = obj.geometry;
0782 
0783             <span class="comment">% Set useImaginary flag</span>
0784             generalStruct.useImaginary = obj.absorption;
0785             
0786             <span class="comment">% Parameters</span>
0787             params = obj.parameters.toStruct();
0788             paramStruct = cell2struct(struct2cell(params),{<span class="string">'paramNames'</span>,<span class="keyword">...</span>
0789                 <span class="string">'nParams'</span>,<span class="string">'paramConstr'</span>,<span class="string">'params'</span>,<span class="string">'paramFitYesNo'</span>,<span class="string">'paramPriors'</span>});
0790             
0791             <span class="comment">% Backgrounds</span>
0792             backgroundStruct = obj.background.toStruct();
0793             
0794             <span class="comment">% Resolutions</span>
0795             resolutionStruct = obj.resolution.toStruct();
0796             
0797             <span class="comment">% Bulk in</span>
0798             bulkInStruct = obj.bulkIn.toStruct();
0799             bulkInStruct = cell2struct(struct2cell(bulkInStruct),{<span class="string">'nbairNames'</span>,<span class="keyword">...</span>
0800                 <span class="string">'nNba'</span>,<span class="string">'nbairConstr'</span>,<span class="string">'nbairs'</span>,<span class="string">'nbaFitYesNo'</span>,<span class="string">'nbaPriors'</span>});
0801             
0802             <span class="comment">% Bulk out</span>
0803             bulkOutStruct = obj.bulkOut.toStruct();
0804             bulkOutStruct = cell2struct(struct2cell(bulkOutStruct),{<span class="string">'nbsubNames'</span>,<span class="keyword">...</span>
0805                 <span class="string">'nNbs'</span>,<span class="string">'nbsubConstr'</span>,<span class="string">'nbsubs'</span>,<span class="string">'nbsFitYesNo'</span>,<span class="string">'nbsPriors'</span>});
0806             
0807             <span class="comment">% Scalefactors</span>
0808             scalefactorStruct = obj.scalefactors.toStruct();
0809             scalefactorStruct = cell2struct(struct2cell(scalefactorStruct),{<span class="string">'scalefactorNames'</span>,<span class="keyword">...</span>
0810                 <span class="string">'nScalefactors'</span>,<span class="string">'scalefactorConstr'</span>,<span class="string">'scalefactors'</span>,<span class="string">'scalefactorFitYesNo'</span>,<span class="string">'scalefactorPriors'</span>});
0811             
0812             <span class="comment">% Qzshifts</span>
0813             qzshiftStruct = obj.qzshifts.toStruct();
0814             qzshiftStruct = cell2struct(struct2cell(qzshiftStruct),{<span class="string">'qzshiftNames'</span>,<span class="keyword">...</span>
0815                 <span class="string">'nQzshifts'</span>,<span class="string">'qzshiftConstr'</span>,<span class="string">'qzshifts'</span>,<span class="string">'qzshiftFitYesNo'</span>,<span class="string">'qzshiftPriors'</span>});
0816             
0817             <span class="comment">% Layers</span>
0818             layersStruct = obj.layers.toStruct(paramStruct.paramNames, generalStruct.modelType);
0819 
0820             <span class="comment">% Custom files</span>
0821             customFileStruct = obj.customFile.toStruct();
0822             
0823             <span class="comment">% Contrasts</span>
0824             allNames = obj.getAllAllowedNames;
0825             dataTable = obj.data.varTable;
0826             
0827             contrastStruct = obj.contrasts.toStruct(allNames, generalStruct.modelType, dataTable);
0828 
0829             <span class="comment">% Merge all the outputs into one large structure</span>
0830             outStruct = <a href="mergeStructs.html" class="code" title="function outStruct = mergeStructs(varargin)">mergeStructs</a>(generalStruct, <span class="keyword">...</span>
0831                                      paramStruct, <span class="keyword">...</span>
0832                                      backgroundStruct, <span class="keyword">...</span>
0833                                      resolutionStruct, <span class="keyword">...</span>
0834                                      bulkInStruct, <span class="keyword">...</span>
0835                                      bulkOutStruct, <span class="keyword">...</span>
0836                                      scalefactorStruct, <span class="keyword">...</span>
0837                                      qzshiftStruct, <span class="keyword">...</span>
0838                                      layersStruct, <span class="keyword">...</span>
0839                                      customFileStruct, <span class="keyword">...</span>
0840                                      contrastStruct);
0841             
0842         <span class="keyword">end</span>
0843         
0844     <span class="keyword">end</span>     <span class="comment">% end public methods</span>
0845     
0846     <span class="comment">% ------------------------------------------------------------------</span>
0847     
0848     methods (Access = protected)
0849         <span class="comment">% Display methods</span>
0850         <a name="_sub56" href="#_subfunctions" class="code">function group = getPropertyGroup1(obj)</a>
0851             <span class="comment">% Initial Parameters at the start of the class</span>
0852             masterPropList = struct(<span class="string">'modelType'</span>,{obj.modelType},<span class="keyword">...</span>
0853                 <span class="string">'experimentName'</span>,{obj.experimentName},<span class="keyword">...</span>
0854                 <span class="string">'geometry'</span>, obj.geometry);
0855             
0856             <span class="keyword">if</span> isscalar(obj)
0857                 group = matlab.mixin.util.PropertyGroup(masterPropList);
0858             <span class="keyword">else</span>
0859                 group = <a href="#_sub57" class="code" title="subfunction group = getPropertyGroup1(obj)">getPropertyGroup1</a>@matlab.mixin.CustomDisplay(obj);
0860             <span class="keyword">end</span>
0861         <span class="keyword">end</span>
0862         
0863         <a name="_sub57" href="#_subfunctions" class="code">function displayScalarObject(obj)</a>
0864             <span class="comment">% Display the whole class. Call the display methods for</span>
0865             <span class="comment">% the sub-classes where appropriate</span>
0866             
0867             <span class="comment">% There are two versions, depending on whether the model</span>
0868             <span class="comment">% is standard layers or custom, the difference being</span>
0869             <span class="comment">% the display of the layers table..</span>
0870             
0871             <span class="comment">% Display initial properties</span>
0872             startProps = <a href="#_sub57" class="code" title="subfunction group = getPropertyGroup1(obj)">getPropertyGroup1</a>(obj);
0873             matlab.mixin.CustomDisplay.displayPropertyGroups(obj,startProps);
0874             
0875             <span class="comment">% Display the parameters table</span>
0876             fprintf(<span class="string">'\n    Parameters: ---------------------------------------------------------------------------------------------- \n\n'</span>);
0877             obj.parameters.displayTable;
0878             
0879             <span class="comment">% Display the layers table if not a custom model</span>
0880             val = obj.modelType;
0881             <span class="keyword">if</span> ~any(strcmpi(val,{<span class="string">'custom layers'</span>,<span class="string">'custom xy'</span>}))
0882                 fprintf(<span class="string">'\n    Layers: -------------------------------------------------------------------------------------------------- \n\n'</span>);
0883                 obj.layers.displayTable;
0884             <span class="keyword">end</span>
0885             
0886             <span class="comment">% Display the Bulk In table</span>
0887             fprintf(<span class="string">'\n    Bulk In: -------------------------------------------------------------------------------------------------- \n\n'</span>);
0888             obj.bulkIn.displayTable;
0889             
0890             <span class="comment">% Display the Bulk Out table</span>
0891             fprintf(<span class="string">'\n    Bulk Out: ------------------------------------------------------------------------------------------------- \n\n'</span>);
0892             obj.bulkOut.displayTable;
0893             
0894             <span class="comment">% Display the Scalefactors table</span>
0895             fprintf(<span class="string">'\n    Scalefactors: ------------------------------------------------------------------------------------------------- \n\n'</span>);
0896             obj.scalefactors.displayTable;
0897 
0898             <span class="comment">% Display the backgrounds object</span>
0899             fprintf(<span class="string">'\n    Backgrounds: ----------------------------------------------------------------------------------------------- \n\n'</span>);
0900             obj.background.displayBackgroundsObject;
0901             
0902             <span class="comment">% Display the resolutions object</span>
0903             fprintf(<span class="string">'\n    Resolutions: --------------------------------------------------------------------------------------------- \n\n'</span>);
0904             obj.resolution.displayResolutionsObject;
0905             
0906             <span class="comment">% Display the data object</span>
0907             fprintf(<span class="string">'\n    Data: ------------------------------------------------------------------------------------------------------ \n\n'</span>);
0908             obj.data.displayTable;
0909             
0910             <span class="comment">% Display custom files object</span>
0911             fprintf(<span class="string">'\n    Custom Files: ------------------------------------------------------------------------------------------------------ \n\n'</span>);
0912             obj.customFile.displayTable;
0913             
0914             <span class="comment">% Display the contrasts object</span>
0915             fprintf(<span class="string">'\n   Contrasts: ----------------------------------------------------------------------------------------------- \n\n'</span>);
0916             obj.contrasts.displayContrastsObject;
0917             
0918         <span class="keyword">end</span>
0919         
0920     <span class="keyword">end</span>
0921 
0922     methods (Access = protected, Hidden)
0923 
0924         <a name="_sub58" href="#_subfunctions" class="code">function modifyLayersTable(obj,~,~)</a>
0925             <span class="comment">% Add or remove a column from the layers table whenever the</span>
0926             <span class="comment">% &quot;absorption&quot; property is modified.</span>
0927             <span class="keyword">if</span> obj.absorption
0928                 newCol = repmat(&quot;&quot;, height(obj.layers.varTable), 1);
0929                 obj.layers.varTable = addvars(obj.layers.varTable, newCol, <span class="string">'After'</span>, <span class="string">'SLD'</span>, <span class="string">'NewVariableNames'</span>, <span class="string">'SLD Imaginary'</span>);
0930                 obj.layers.varTable = renamevars(obj.layers.varTable, <span class="string">'SLD'</span>, <span class="string">'SLD Real'</span>);
0931             <span class="keyword">else</span>
0932                 obj.layers.varTable = removevars(obj.layers.varTable, <span class="string">'SLD Imaginary'</span>);
0933                 obj.layers.varTable = renamevars(obj.layers.varTable, <span class="string">'SLD Real'</span>, <span class="string">'SLD'</span>);
0934             <span class="keyword">end</span>
0935         <span class="keyword">end</span>
0936 
0937     <span class="keyword">end</span>
0938 
0939     methods (Hidden)
0940 
0941         <a name="_sub59" href="#_subfunctions" class="code">function domainsObj = domainsClass(obj)</a>
0942             <span class="comment">% Converter routine from projectClass to domainsClass.</span>
0943             <span class="comment">% This routine takes the currently defined project and</span>
0944             <span class="comment">% converts it to a domains calculation, preserving all</span>
0945             <span class="comment">% currently defined properties.</span>
0946             <span class="comment">%</span>
0947             <span class="comment">% domainsProblem = problem.domainsClass();</span>
0948             domainsObj = <a href="domainsClass.html" class="code" title="">domainsClass</a>(obj.experimentName, calculationTypes.Domains, obj.geometry, obj.absorption);
0949             domainsObj = copyProperties(obj, domainsObj);
0950 
0951             <span class="comment">% Need to treat contrasts separately due to changes in the</span>
0952             <span class="comment">% class for domains calculations</span>
0953             domainsObj.contrasts = copyProperties(obj.contrasts, <a href="contrastsClass.html" class="code" title="">contrastsClass</a>(domains=true, oilWater=obj.contrasts.oilWaterCalc));
0954             <span class="keyword">for</span> i=1:domainsObj.contrasts.numberOfContrasts
0955                 domainsObj.contrasts.contrasts{i}.domainRatio = <span class="string">''</span>;
0956             <span class="keyword">end</span>
0957         <span class="keyword">end</span>
0958 
0959     <span class="keyword">end</span>
0960 
0961 <span class="keyword">end</span>
</pre></div>

<hr><address>Generated on Tue 20-Jun-2023 16:21:19 by <strong><a href="https://github.com/gllmflndn/m2html">m2html</a></strong> &copy; 2003-2022</address>
</body>
</html>

<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
                "http://www.w3.org/TR/REC-html40/loose.dtd">
<html>
<head>
  <title>Description of resolutionsClass</title>
  <meta name="keywords" content="resolutionsClass">
  <meta name="description" content="">
  <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
  <meta name="generator" content="m2html &copy; 2003-2019 Guillaume Flandin">
  <meta name="robots" content="index, follow">
  <link type="text/css" rel="stylesheet" href="../../m2html.css">
  <script type="text/javascript">
    if (top.frames.length == 0) { top.location = "../../index.html"; };
  </script>
</head>
<body>
<a name="_top"></a>
<!-- ../menu.html API -->
<!-- menu.html projectClass -->

<h1>resolutionsClass
</h1>

<h2><a name="_name"></a>PURPOSE <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
<div class="box"><strong></strong></div>

<h2><a name="_synopsis"></a>SYNOPSIS <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
<div class="box"><strong>This is a script file. </strong></div>

<h2><a name="_description"></a>DESCRIPTION <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
<div class="fragment"><pre class="comment"></pre></div>

<!-- crossreference -->
<h2><a name="_cross"></a>CROSS-REFERENCE INFORMATION <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
This function calls:
<ul style="list-style-image:url(../../matlabicon.gif)">
<li><a href="multiTypeTable.html" class="code" title="">multiTypeTable</a>	</li>
<li><a href="resolutionsClass.html" class="code" title="">resolutionsClass</a>	</li>
</ul>
This function is called by:
<ul style="list-style-image:url(../../matlabicon.gif)">
<li><a href="projectClass.html" class="code" title="">projectClass</a>	</li>
<li><a href="resolutionsClass.html" class="code" title="">resolutionsClass</a>	</li>
</ul>
<!-- crossreference -->

<h2><a name="_subfunctions"></a>SUBFUNCTIONS <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
<ul style="list-style-image:url(../../matlabicon.gif)">
<li><a href="#_sub1" class="code">function  obj = resolutionsClass(parameters, startResolution)</a></li>
<li><a href="#_sub2" class="code">function flag = get.showPriors(obj)</a></li>
<li><a href="#_sub3" class="code">function set.showPriors(obj, value)</a></li>
<li><a href="#_sub4" class="code">function names = getNames(obj)</a></li>
<li><a href="#_sub5" class="code">function addResolution(obj, varargin)</a></li>
<li><a href="#_sub6" class="code">function removeResolution(obj, row)</a></li>
<li><a href="#_sub7" class="code">function setResolution(obj, row, varargin)</a></li>
<li><a href="#_sub8" class="code">function resolutionStruct = toStruct(obj)</a></li>
<li><a href="#_sub9" class="code">function displayResolutionsObject(obj)</a></li>
<li><a href="#_sub10" class="code">function thisPar = validateParam(obj, param)</a></li>
</ul>


<h2><a name="_source"></a>SOURCE CODE <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
<div class="fragment"><pre>0001 classdef <a href="resolutionsClass.html" class="code" title="">resolutionsClass</a> &lt; handle
0002     <span class="comment">% Resolutions are defined in a two stage process. Firstly we define the</span>
0003     <span class="comment">% actual fitted parameters. These are held in a 'ParametersClass'</span>
0004     <span class="comment">% table. Then, we group these into the resolutions themselves using a</span>
0005     <span class="comment">% multiTypeTable. So, we can then use the resolution parameters to</span>
0006     <span class="comment">% either define resolution as  constant, data or a function.</span>
0007     <span class="comment">%</span>
0008     <span class="comment">% For constant only one parameter is supplied to multi type table.</span>
0009     <span class="comment">%</span>
0010     <span class="comment">% For data the name is supplied, along with the name of the data in the</span>
0011     <span class="comment">% data table.</span>
0012     <span class="comment">%</span>
0013     <span class="comment">% For function, the function name is supplied, along with up to three parameters (from the</span>
0014     <span class="comment">% parameters table) which are then supplied to the function to calculate the resolution.</span>
0015     
0016     properties   
0017        resolutionParams 
0018        resolutions
0019     <span class="keyword">end</span>
0020 
0021     properties(Dependent)
0022        showPriors
0023     <span class="keyword">end</span>
0024     
0025     properties(Access = private, Constant, Hidden)
0026         invalidTypeMessage = sprintf(<span class="string">'Allowed type must be a allowedTypes enum or one of the following strings (%s)'</span>, <span class="keyword">...</span>
0027                                      strjoin(allowedTypes.values(), <span class="string">', '</span>))
0028     <span class="keyword">end</span>
0029     
0030     methods
0031         <a name="_sub0" href="#_subfunctions" class="code">function  obj = resolutionsClass(parameters, startResolution) </a>
0032             <span class="comment">% Creates a Resolutions object. The arguments should be</span>
0033             <span class="comment">% an instance of the parameter class with the resolution parameters and a</span>
0034             <span class="comment">% cell array with the first resolution entry</span>
0035             <span class="comment">%</span>
0036             <span class="comment">% params = parametersClass({'Resolution Param 1', 0.01, 0.03, 0.05, false});</span>
0037             <span class="comment">% resolution = resolutionsClass(params , {'Resolution 1', 'constant', 'Tails'});</span>
0038             obj.resolutionParams = parameters;
0039             
0040             <span class="comment">% Make a multiType table to define the actual resolutions</span>
0041             obj.resolutions = <a href="multiTypeTable.html" class="code" title="">multiTypeTable</a>();
0042             obj.resolutions.typesAutoNameString = <span class="string">'New Resolution'</span>;
0043             obj.addResolution(startResolution{:});
0044         <span class="keyword">end</span>
0045         
0046         <a name="_sub1" href="#_subfunctions" class="code">function flag = get.showPriors(obj)</a>
0047             flag = obj.resolutionParams.showPriors;
0048         <span class="keyword">end</span>
0049         
0050         <a name="_sub2" href="#_subfunctions" class="code">function set.showPriors(obj, value)</a>
0051             obj.resolutionParams.showPriors = value;
0052         <span class="keyword">end</span>
0053         
0054         <a name="_sub3" href="#_subfunctions" class="code">function names = getNames(obj)</a>
0055             <span class="comment">% Returns a N x 1 cell array of names of the resolutions</span>
0056             <span class="comment">% in the object.</span>
0057             <span class="comment">%</span>
0058             <span class="comment">% names = resolution.getNames();</span>
0059             resolTable = obj.resolutions.varTable;
0060             names = resolTable{:,1};   
0061         <span class="keyword">end</span>
0062          
0063         <a name="_sub4" href="#_subfunctions" class="code">function addResolution(obj, varargin)</a>
0064             <span class="comment">% Adds a new entry to the resolution table.</span>
0065             <span class="comment">%</span>
0066             <span class="comment">% resolution.addResolution('New Row');</span>
0067             <span class="comment">% resolution.addResolution('New Row', 'constant', 'param_name');</span>
0068             <span class="comment">% resolution.addResolution('New Row', 'function', 'function_name', 'param_name');</span>
0069             <span class="comment">% resolution.addResolution('New Row', 'data');</span>
0070             in = varargin;
0071             
0072             <span class="keyword">if</span> isempty(in)
0073                 thisRow = {};
0074             <span class="keyword">else</span>
0075                 thisRow = {<span class="string">''</span>,<span class="string">''</span>,<span class="string">''</span>,<span class="string">''</span>,<span class="string">''</span>,<span class="string">''</span>,<span class="string">''</span>}; 
0076                 <span class="keyword">if</span> length(in) == 1
0077                     <span class="comment">% Assume the input is just a name</span>
0078                     thisRow = {in};
0079                 <span class="keyword">else</span>
0080                     thisRow{1} = in;
0081                 <span class="keyword">end</span>
0082             <span class="keyword">end</span>
0083             
0084             <span class="keyword">if</span> length(in) &gt; 1 
0085                <span class="comment">% Check that second param is legal</span>
0086                typeVal = validateOption(in{2}, <span class="string">'allowedTypes'</span>, obj.invalidTypeMessage).value;
0087 
0088                <span class="keyword">if</span> any(strcmpi(typeVal, {allowedTypes.Constant.value, allowedTypes.Function.value})) &amp;&amp; length(in) &lt; 3
0089                    throw(exceptions.invalidNumberOfInputs(sprintf(<span class="string">'For type ''%s'', at least three inputs are required, but only %d are supplied'</span>, typeVal, length(in))));
0090                <span class="keyword">end</span>
0091 
0092                thisRow{1} = in{1};
0093                thisRow{2} = in{2};
0094 
0095                <span class="comment">% Check that the other params inputted are either valid</span>
0096                <span class="comment">% resolution names, or numbers in range..</span>
0097                <span class="keyword">switch</span> typeVal
0098                    <span class="keyword">case</span> allowedTypes.Constant.value
0099                        <span class="comment">% Param 3 must be a valid parameter</span>
0100                        thisParam = obj.validateParam(in(3));
0101                        thisRow{3} = thisParam;
0102 
0103                    <span class="keyword">case</span> allowedTypes.Function.value
0104                        <span class="comment">% Param 3 is assumed to be function name</span>
0105                        <span class="comment">% any other given parameters must be in paramNames</span>
0106                        <span class="comment">% list or numbers in range</span>
0107                        thisRow{3} = in{3};
0108                        <span class="keyword">for</span> i = 4:length(in)
0109                           thisParam = obj.validateParam(in(i));
0110                           thisRow{i} = thisParam;
0111                        <span class="keyword">end</span>
0112                        
0113                    <span class="keyword">case</span> allowedTypes.Data.value
0114                        <span class="comment">% Resolution is assumed to be given by a 4th column</span>
0115                        <span class="comment">% of a data file. We don't have access to the</span>
0116                        <span class="comment">% data files at this point so this (i.e. that data is</span>
0117                        <span class="comment">% [n x 4] ) will be checked downstream</span>
0118                        thisRow = {in{1}, in{2}, <span class="string">''</span>, <span class="string">''</span>, <span class="string">''</span>, <span class="string">''</span>, <span class="string">''</span>};
0119                 <span class="keyword">end</span>
0120             <span class="keyword">end</span>
0121             obj.resolutions.addRow(thisRow{:});      
0122         <span class="keyword">end</span>
0123         
0124         <a name="_sub5" href="#_subfunctions" class="code">function removeResolution(obj, row)</a>
0125             <span class="comment">% Removes a resolution entry from the table. Expects the</span>
0126             <span class="comment">% index or array of indices of resolution(s) to remove.</span>
0127             <span class="comment">%</span>
0128             <span class="comment">% resolution.removeResolution(2);</span>
0129             <span class="comment">% resolution.removeResolution([1, 3]);</span>
0130             obj.resolutions.removeRow(row);
0131         <span class="keyword">end</span>
0132         
0133         <a name="_sub6" href="#_subfunctions" class="code">function setResolution(obj, row, varargin)</a>
0134             <span class="comment">% Changes the value of a given resolution in the table. Expects the</span>
0135             <span class="comment">% index or name of resolution and keyword/value pairs to set.</span>
0136             <span class="comment">%</span>
0137             <span class="comment">% resolution.setResolution(1, 'name', 'res 1', 'type', 'constant', 'value1', 'param_name');</span>
0138             <span class="keyword">if</span> isText(row)
0139                 row = obj.resolutions.findRowIndex(row, obj.getNames(), <span class="string">'Unrecognised resolution'</span>);
0140             <span class="keyword">elseif</span> isnumeric(row)
0141                 count = obj.resolutions.rowCount;
0142                 <span class="keyword">if</span> (row &lt; 1) || (row &gt; count)
0143                     throw(exceptions.indexOutOfRange(sprintf(<span class="string">'The row index %d is not within the range 1 - %d'</span>, row, count)));
0144                 <span class="keyword">end</span>
0145             <span class="keyword">else</span>
0146                 throw(exceptions.invalidType(<span class="string">'Unrecognised row'</span>));
0147             <span class="keyword">end</span>
0148             
0149             p = inputParser;
0150             addParameter(p, <span class="string">'name'</span>, obj.resolutions.varTable{row, 1}, @(x) isText(x));
0151             addParameter(p, <span class="string">'type'</span>, obj.resolutions.varTable{row, 2}, @(x) isText(x) || isenum(x));
0152             addParameter(p, <span class="string">'value1'</span>, obj.resolutions.varTable{row, 3}, @(x) isText(x));
0153             addParameter(p, <span class="string">'value2'</span>, obj.resolutions.varTable{row, 4}, @(x) isText(x));
0154             addParameter(p, <span class="string">'value3'</span>, obj.resolutions.varTable{row, 5}, @(x) isText(x));
0155             addParameter(p, <span class="string">'value4'</span>, obj.resolutions.varTable{row, 6}, @(x) isText(x));
0156 
0157             parse(p, varargin{:});
0158             inputBlock = p.Results;
0159 
0160             obj.resolutions.setValue(row, 1, inputBlock.name);
0161             
0162             <span class="keyword">if</span> ~isempty(inputBlock.type)
0163                 inputBlock.type = validateOption(inputBlock.type, <span class="string">'allowedTypes'</span>, obj.invalidTypeMessage).value;
0164                 obj.resolutions.setValue(row, 2, inputBlock.type);
0165             <span class="keyword">end</span>    
0166             values = {inputBlock.value1, inputBlock.value2, inputBlock.value3, inputBlock.value4};
0167             <span class="keyword">for</span> i = 1:4
0168                 value = convertStringsToChars(values{i});
0169                 <span class="comment">% for function type, value 1 is the function name so no validation is done</span>
0170                 <span class="keyword">if</span> ~isempty(value) &amp;&amp; ~(i==1 &amp;&amp; strcmpi(inputBlock.type,allowedTypes.Function.value))
0171                     value = obj.validateParam(value);
0172                 <span class="keyword">end</span>
0173                 obj.resolutions.setValue(row, i + 2, value);
0174             <span class="keyword">end</span>
0175         <span class="keyword">end</span>
0176         
0177         <a name="_sub7" href="#_subfunctions" class="code">function resolutionStruct = toStruct(obj)</a>
0178             <span class="comment">% Converts the class parameters into a structure array.</span>
0179             resolutionParamsStruct = obj.resolutionParams.toStruct();
0180             
0181             resolutionStruct.resolutionParamNames = resolutionParamsStruct.names;
0182             resolutionStruct.resolutionParamLimits = resolutionParamsStruct.limits;
0183             resolutionStruct.resolutionParamValues = resolutionParamsStruct.values;
0184             resolutionStruct.fitResolutionParam = resolutionParamsStruct.fit;
0185             resolutionStruct.resolutionParamPriors = resolutionParamsStruct.priors;
0186             
0187             resolutionNames = obj.resolutions.varTable{:,1};
0188             resolutionTypes = obj.resolutions.varTable{:,2};
0189             resolutionValues = table2cell(obj.resolutions.varTable(:,3:7));
0190             
0191             resolutionStruct.resolutionNames = resolutionNames;
0192             resolutionStruct.resolutionTypes = resolutionTypes;
0193             resolutionStruct.resolutionValues = resolutionValues;  
0194          <span class="keyword">end</span>
0195         
0196         <a name="_sub8" href="#_subfunctions" class="code">function displayResolutionsObject(obj)</a>
0197             <span class="comment">% Displays the resolution parameters and resolution table.</span>
0198             fprintf(<span class="string">'    (a) Resolutions Parameters: \n\n'</span>);
0199             obj.resolutionParams.displayTable;
0200             
0201             fprintf(<span class="string">'    (b) Resolutions:  \n\n'</span>)
0202             obj.resolutions.displayTable;
0203         <span class="keyword">end</span> 
0204     <span class="keyword">end</span>
0205 
0206     methods (Access = protected)
0207         <a name="_sub9" href="#_subfunctions" class="code">function thisPar = validateParam(obj, param)</a>
0208             <span class="comment">% Checks that given parameter index or name is valid, then returns the</span>
0209             <span class="comment">% parameter name.</span>
0210             <span class="comment">%</span>
0211             <span class="comment">% param = obj.validateParam('param_name');</span>
0212             <span class="keyword">if</span> iscell(param)
0213                 param = param{:};
0214             <span class="keyword">end</span>
0215             parList = obj.resolutionParams.getNames(); 
0216             <span class="keyword">if</span> isnumeric(param)
0217                 <span class="keyword">if</span> (param &lt; 1) || (param &gt; length(parList))
0218                     throw(exceptions.indexOutOfRange(sprintf(<span class="string">'Resolution Parameter %d is out of range'</span>, param)));
0219                 <span class="keyword">end</span>
0220                 thisPar = parList(param);
0221             <span class="keyword">else</span>
0222                 <span class="keyword">if</span> ~strcmpi(param, parList)
0223                     throw(exceptions.nameNotRecognised(sprintf(<span class="string">'Unrecognised parameter name %s'</span>, param)));
0224                 <span class="keyword">end</span>
0225                 thisPar = param;
0226             <span class="keyword">end</span>   
0227         <span class="keyword">end</span>
0228     <span class="keyword">end</span>
0229 <span class="keyword">end</span> 
</pre></div>

<hr><address>Generated on Mon 04-Dec-2023 13:09:56 by <strong><a href="https://github.com/gllmflndn/m2html">m2html</a></strong> &copy; 2003-2022</address>
</body>
</html>

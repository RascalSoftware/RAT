<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
                "http://www.w3.org/TR/REC-html40/loose.dtd">
<html>
<head>
  <title>Description of resolutionsClass</title>
  <meta name="keywords" content="resolutionsClass">
  <meta name="description" content="">
  <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
  <meta name="generator" content="m2html &copy; 2003-2019 Guillaume Flandin">
  <meta name="robots" content="index, follow">
  <link type="text/css" rel="stylesheet" href="../../m2html.css">
  <script type="text/javascript">
    if (top.frames.length == 0) { top.location = "../../index.html"; };
  </script>
</head>
<body>
<a name="_top"></a>
<!-- # API --><!-- # projectClass -->
<h1>resolutionsClass
</h1>

<h2><a name="_name"></a>PURPOSE <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
<div class="box"><strong></strong></div>

<h2><a name="_synopsis"></a>SYNOPSIS <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
<div class="box"><strong>This is a script file. </strong></div>

<h2><a name="_description"></a>DESCRIPTION <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
<div class="fragment"><pre class="comment"></pre></div>

<!-- crossreference -->
<h2><a name="_cross"></a>CROSS-REFERENCE INFORMATION <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
This function calls:
<ul style="list-style-image:url(../../matlabicon.gif)">
<li><a href="multiTypeTable.html" class="code" title="">multiTypeTable</a>	</li><li><a href="parametersClass.html" class="code" title="">parametersClass</a>	</li><li><a href="resolutionsClass.html" class="code" title="">resolutionsClass</a>	</li></ul>
This function is called by:
<ul style="list-style-image:url(../../matlabicon.gif)">
<li><a href="projectClass.html" class="code" title="">projectClass</a>	</li><li><a href="resolutionsClass.html" class="code" title="">resolutionsClass</a>	</li></ul>
<!-- crossreference -->

<h2><a name="_subfunctions"></a>SUBFUNCTIONS <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
<ul style="list-style-image:url(../../matlabicon.gif)">
<li><a href="#_sub1" class="code">function  obj = resolutionsClass(varargin)</a></li><li><a href="#_sub2" class="code">function names = getResolNames(obj)</a></li><li><a href="#_sub3" class="code">function names = getResolParNames(obj)</a></li><li><a href="#_sub4" class="code">function obj = addResolPar(obj,varargin)</a></li><li><a href="#_sub5" class="code">function obj = setResolParValue(obj,varargin)</a></li><li><a href="#_sub6" class="code">function obj = setResolParConstr(obj,varargin)</a></li><li><a href="#_sub7" class="code">function obj = setResolParName(obj,varargin)</a></li><li><a href="#_sub8" class="code">function obj = removeResolPar(obj,varargin)</a></li><li><a href="#_sub9" class="code">function obj = setResolPar(obj, varargin)</a></li><li><a href="#_sub10" class="code">function obj = addResolution(obj,varargin)</a></li><li><a href="#_sub11" class="code">function obj = removeResolution(obj, varargin)</a></li><li><a href="#_sub12" class="code">function obj = setResolutionValue(obj,varargin)</a></li><li><a href="#_sub13" class="code">function obj = setResolutionName(obj,varargin)</a></li><li><a href="#_sub14" class="code">function resolStruct = toStruct(obj)</a></li><li><a href="#_sub15" class="code">function displayResolutionsObject(obj)</a></li><li><a href="#_sub16" class="code">function thisPar = parseParam(par,parList)</a></li></ul>

<h2><a name="_source"></a>SOURCE CODE <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
<div class="fragment"><pre>0001 classdef <a href="resolutionsClass.html" class="code" title="">resolutionsClass</a> &lt; handle
0002      
0003     <span class="comment">% This makes the rosolutions class.</span>
0004     <span class="comment">% Like Backgrounds, reolutions are defined in a two stage process. Firstly we define the</span>
0005     <span class="comment">% actual fitted parameters. These are held in a 'ParametersClass'</span>
0006     <span class="comment">% table. Then, we group these into the resolutions themselves using a</span>
0007     <span class="comment">% multiTypeTable. So, we can then use the resolution parameters to</span>
0008     <span class="comment">% either define resolution as  constant, data or a function. For</span>
0009     <span class="comment">% constant only one parameter is supplied to multi type table. For data</span>
0010     <span class="comment">% the name is supplied, along with the name of the data in the</span>
0011     <span class="comment">% data table. For function, the function</span>
0012     <span class="comment">% name is supplied, allong with up to three parameters (from the</span>
0013     <span class="comment">% parameters table) which are then supplied to the function to</span>
0014     <span class="comment">% calculate the resolution.</span>
0015     
0016     properties
0017         
0018        resolPars 
0019        resolutions
0020        showPriors = false
0021        
0022     <span class="keyword">end</span>
0023     
0024     properties (Access = private)
0025        allowedTypes = {<span class="string">'constant'</span>, <span class="string">'data'</span>, <span class="string">'function'</span>};
0026     <span class="keyword">end</span>
0027     
0028 
0029     methods
0030         <a name="_sub0" href="#_subfunctions" class="code">function  obj = resolutionsClass(varargin) </a>
0031             
0032             startResolPars = varargin{1};
0033             startResolutions = varargin{2};
0034             
0035             <span class="comment">% Make a table to hold the fittable variables</span>
0036             obj.resolPars = <a href="parametersClass.html" class="code" title="">parametersClass</a>(startResolPars);
0037             
0038             <span class="comment">% Make a multiType table to define the actual resolutions</span>
0039             obj.resolutions = <a href="multiTypeTable.html" class="code" title="">multiTypeTable</a>(startResolutions);
0040             obj.resolutions.allowedTypes = obj.allowedTypes;
0041             obj.resolutions.typesAutoNameString = <span class="string">'New Resolution'</span>;
0042 
0043         <span class="keyword">end</span>
0044         
0045         <a name="_sub1" href="#_subfunctions" class="code">function names = getResolNames(obj)</a>
0046             
0047             resolTable = obj.resolutions.typesTable;
0048             names = resolTable{:,1};
0049             
0050         <span class="keyword">end</span>
0051         
0052         <a name="_sub2" href="#_subfunctions" class="code">function names = getResolParNames(obj)</a>
0053             
0054             resolParTable = obj.resolPars.paramsTable;
0055             names = resolParTable{:,1};
0056             
0057         <span class="keyword">end</span>
0058 
0059         
0060         <span class="comment">% --- resolParams table edit methods -----------------------</span>
0061         
0062         <a name="_sub3" href="#_subfunctions" class="code">function obj = addResolPar(obj,varargin)</a>
0063             
0064             <span class="comment">% Add a parameter to the resol parameter table</span>
0065             in = varargin{:};
0066             resolParsTable = obj.resolPars;
0067             <span class="keyword">if</span> isempty(in)
0068                 <span class="comment">% Empty call - pass no parameter</span>
0069                 resolParsTable = resolParsTable.addParam();
0070             <span class="keyword">elseif</span> length(in) == 1
0071                 <span class="comment">% Name only being passed</span>
0072                 resolParsTable = resolParsTable.addParam(in);
0073             <span class="keyword">else</span>
0074                 <span class="comment">% Passing a fuller expression - pass it all</span>
0075                 resolParsTable = resolParsTable.addParam(in);
0076             <span class="keyword">end</span>
0077             obj.resolPars = resolParsTable;    
0078 
0079         <span class="keyword">end</span>
0080         
0081         <a name="_sub4" href="#_subfunctions" class="code">function obj = setResolParValue(obj,varargin)</a>
0082             <span class="comment">% Set a parameter value in the resol parameter table</span>
0083             obj.resolPars.setValue(varargin{:});
0084         <span class="keyword">end</span>
0085         
0086         <a name="_sub5" href="#_subfunctions" class="code">function obj = setResolParConstr(obj,varargin)</a>
0087             <span class="comment">% Set a parameter constraint in the resol parameter table</span>
0088             obj.resolPars.setConstr(varargin{:});
0089         <span class="keyword">end</span>
0090         
0091         <a name="_sub6" href="#_subfunctions" class="code">function obj = setResolParName(obj,varargin)</a>
0092            <span class="comment">% Set a parameter name in the resol parameter table</span>
0093            obj.resolPars.setName(varargin{:});
0094         <span class="keyword">end</span>
0095         
0096         <a name="_sub7" href="#_subfunctions" class="code">function obj = removeResolPar(obj,varargin)</a>
0097             <span class="comment">% Remove a parameter from the backsPar table</span>
0098             obj.resolPars.removeParam(varargin{:});
0099         <span class="keyword">end</span>
0100         
0101         <a name="_sub8" href="#_subfunctions" class="code">function obj = setResolPar(obj, varargin)</a>
0102            <span class="comment">% General purpose backPar set using name / value pairs</span>
0103            obj.resolPars.setParameter(varargin{:});
0104             
0105         <span class="keyword">end</span>
0106         
0107         <span class="comment">% ---------------------------------------------------------</span>
0108          
0109         <a name="_sub9" href="#_subfunctions" class="code">function obj = addResolution(obj,varargin)</a>
0110             
0111             <span class="comment">% Decide on what type of set we are</span>
0112             <span class="comment">% doing, make sure the inputs are valid and build the row cell</span>
0113             <span class="comment">% to be added</span>
0114             
0115             in = varargin{:};
0116             paramNames = obj.resolPars.paramsTable{:,1};
0117             
0118             <span class="keyword">if</span> isempty(in)
0119                 thisRow = {};
0120             <span class="keyword">else</span>
0121                 thisRow = {<span class="string">''</span>,<span class="string">''</span>,<span class="string">''</span>,<span class="string">''</span>,<span class="string">''</span>,<span class="string">''</span>,<span class="string">''</span>};
0122             <span class="keyword">end</span>
0123             
0124             <span class="keyword">if</span> length(in) == 1
0125                 <span class="comment">% Assume the input is just a name</span>
0126                 thisRow{1} = in;
0127             
0128             <span class="keyword">elseif</span> length(in) &gt; 1
0129                
0130                <span class="comment">% Check that second param is legal</span>
0131                typeVal = in{2};
0132                <span class="keyword">if</span> ~strcmpi(typeVal,obj.allowedTypes)
0133                     error(<span class="string">'Unrecognised resolution type %s. Must be ''constant'',''data'', or ''function'''</span>, typeVal);
0134                <span class="keyword">end</span>
0135 
0136                thisRow{1} = in{1};
0137                thisRow{2} = in{2};
0138 
0139                <span class="comment">% Check that the other params inputted are either valid</span>
0140                <span class="comment">% resolution names, or numbers in range..</span>
0141                <span class="keyword">switch</span> typeVal
0142                    <span class="keyword">case</span> <span class="string">'constant'</span>
0143                        <span class="comment">% Param 3 must be a valid parameter</span>
0144                        thisParam = <a href="#_sub16" class="code" title="subfunction thisPar = parseParam(par,parList)">parseParam</a>(in(3),paramNames);
0145                        thisRow{3} = thisParam;
0146 
0147                    <span class="keyword">case</span> <span class="string">'function'</span>
0148                        <span class="comment">% Param 3 is assumed to be function name</span>
0149                        <span class="comment">% any other given parameters must be in paramNames</span>
0150                        <span class="comment">% list or numbers in range</span>
0151                        thisRow{3} = in{3};
0152                        <span class="keyword">for</span> i = 4:length(in)
0153                           thisParam = <a href="#_sub16" class="code" title="subfunction thisPar = parseParam(par,parList)">parseParam</a>(in(i),paramNames);
0154                           thisRow{i} = thisParam;
0155                        <span class="keyword">end</span>
0156                        
0157                    <span class="keyword">case</span> <span class="string">'data'</span>
0158                        <span class="comment">% Resolution is assumed to be given by a 4th column</span>
0159                        <span class="comment">% of a datafile. We don't have access to the</span>
0160                        <span class="comment">% datafiles at this point so this (i.e. that data is</span>
0161                        <span class="comment">% [n x 4] ) will be chacked downstream</span>
0162                        thisRow = {in(1), in(2), <span class="string">''</span>, <span class="string">''</span>, <span class="string">''</span>, <span class="string">''</span>, <span class="string">''</span>};
0163                 <span class="keyword">end</span>
0164             <span class="keyword">end</span>
0165             obj.resolutions.addRow(thisRow);
0166                 
0167         <span class="keyword">end</span>
0168         
0169         <a name="_sub10" href="#_subfunctions" class="code">function obj = removeResolution(obj, varargin)</a>
0170             thisRow = varargin{:};
0171             obj.resolutions.removeRow(thisRow);
0172         <span class="keyword">end</span>
0173         
0174         <a name="_sub11" href="#_subfunctions" class="code">function obj = setResolutionValue(obj,varargin)</a>
0175             
0176             in = varargin{:};
0177             <span class="keyword">if</span> length(in) ~= 3
0178                 error(<span class="string">'Expect three inputs into setResolutionValue'</span>);
0179             <span class="keyword">end</span>
0180             
0181             <span class="comment">% Need to check that param 3 is allowed</span>
0182             <span class="comment">% If it's col 1 or 3, anything is allowed</span>
0183             <span class="comment">% If it's col(2) must be in allowed type of table</span>
0184             <span class="comment">% Other cols must be existing param name or number,</span>
0185             col = in{2};
0186             
0187             <span class="keyword">if</span> isnumeric(col)
0188                 <span class="keyword">if</span> col == 2
0189                     col = <span class="string">'type'</span>;
0190                 <span class="keyword">elseif</span> col == 1
0191                     col = <span class="string">'name'</span>;
0192                 <span class="keyword">elseif</span> col == 3
0193                     col = <span class="string">'Value 1'</span>;
0194                 <span class="keyword">end</span>
0195             <span class="keyword">end</span>
0196                     
0197             <span class="keyword">if</span> strcmpi(col,<span class="string">'name'</span>) || strcmpi(col,<span class="string">'Value 1'</span>)
0198                 <span class="comment">% Do Nothing - any value is allowed so use as is</span>
0199                 inputPar = in{3};
0200             <span class="keyword">elseif</span> strcmpi(col,<span class="string">'type'</span>) 
0201                 allowedList = {<span class="string">'constant'</span>,<span class="string">'data'</span>,<span class="string">'function'</span>};
0202                 inputPar = <a href="#_sub16" class="code" title="subfunction thisPar = parseParam(par,parList)">parseParam</a>(in{3},allowedList);
0203             <span class="keyword">else</span>
0204                 allowedList = obj.resolPars.paramsTable{:,1};
0205                 inputPar = <a href="#_sub16" class="code" title="subfunction thisPar = parseParam(par,parList)">parseParam</a>(in{3},allowedList);
0206             <span class="keyword">end</span>
0207             
0208             in{3} = inputPar;
0209             obj.resolutions.setValue(in);
0210         
0211         <span class="keyword">end</span>
0212         
0213         <a name="_sub12" href="#_subfunctions" class="code">function obj = setResolutionName(obj,varargin)</a>
0214             
0215             disp(<span class="string">'todo'</span>);
0216             
0217         <span class="keyword">end</span>
0218         
0219         <a name="_sub13" href="#_subfunctions" class="code">function resolStruct = toStruct(obj)</a>
0220     
0221             resolParamsStruct = obj.resolPars.toStruct();
0222             
0223             resolStruct.resolParNames = resolParamsStruct.paramNames;
0224             resolStruct.resolParConstr = resolParamsStruct.paramConstr;
0225             resolStruct.resolPars = resolParamsStruct.params;
0226             resolStruct.resolFitYesNo = resolParamsStruct.fitYesNo;
0227             resolStruct.nResolPars = resolParamsStruct.nParams;
0228             resolStruct.resolParPriors = resolParamsStruct.priors;
0229             
0230             resolutionNames = obj.resolutions.typesTable{:,1};
0231             resolutionTypes = obj.resolutions.typesTable{:,2};
0232             resolutionValues = table2cell(obj.resolutions.typesTable(:,3:7));
0233             
0234             resolStruct.resolutionNames = resolutionNames;
0235             resolStruct.resolutionTypes = resolutionTypes;
0236             resolStruct.resolutionValues = resolutionValues;
0237             
0238          <span class="keyword">end</span>
0239 
0240         
0241         <a name="_sub14" href="#_subfunctions" class="code">function displayResolutionsObject(obj)</a>
0242             
0243             fprintf(<span class="string">'    Resolutions: --------------------------------------------------------------------------------------------- \n\n'</span>);
0244             fprintf(<span class="string">'    (a) Resolutions Parameters: \n'</span>);
0245             obj.resolPars.displayParametersTable;
0246             
0247             fprintf(<span class="string">'    (b) Resolutions:  \n'</span>)
0248             obj.resolutions.displayTypesTable;
0249             <span class="comment">%fprintf('\n    ----------------------------------------------------------------------------------- \n\n');</span>
0250             
0251         <span class="keyword">end</span>
0252       
0253     <span class="keyword">end</span>
0254     
0255 <span class="keyword">end</span>
0256 
0257 <a name="_sub15" href="#_subfunctions" class="code">function thisPar = parseParam(par,parList)</a>
0258     
0259     <span class="keyword">if</span> iscell(par)
0260         par = par{:};
0261     <span class="keyword">end</span>
0262 
0263     <span class="keyword">if</span> isnumeric(par)
0264         <span class="keyword">if</span> (par &lt; 1) || (par &gt; length(parList))
0265             error(<span class="string">'Resolution Parameter %d is out of range'</span>,par);
0266         <span class="keyword">else</span>
0267             thisPar = parList(par);
0268         <span class="keyword">end</span>
0269     <span class="keyword">elseif</span> ischar(par)
0270         <span class="keyword">if</span> ~strcmpi(par,parList)
0271             error(<span class="string">'Parameter %s is not recognised'</span>,par);
0272         <span class="keyword">else</span>
0273             thisPar = par;
0274         <span class="keyword">end</span>
0275     <span class="keyword">elseif</span> isempty(par)
0276         error(<span class="string">'Resolution parameter not recognised'</span>);
0277     <span class="keyword">end</span>
0278     
0279 <span class="keyword">end</span> 
0280     
0281     
0282     
0283     
0284     
0285     
0286     
0287     
0288     
0289     
0290     
0291     
0292     
0293     
0294     
0295     
0296     
0297 
0298</pre></div>
<hr><address>Generated on Thu 28-Jul-2022 16:33:05 by <strong><a href="https://www.artefact.tk/software/matlab/m2html/" target="_parent">m2html</a></strong> &copy; 2003-2019</address>
</body>
</html>
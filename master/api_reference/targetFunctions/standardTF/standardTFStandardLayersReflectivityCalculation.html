<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
                "http://www.w3.org/TR/REC-html40/loose.dtd">
<html>
<head>
  <title>Description of standardTFStandardLayersReflectivityCalculation</title>
  <meta name="keywords" content="standardTFStandardLayersReflectivityCalculation">
  <meta name="description" content="Standard layers reflectivity calculation for standardTF">
  <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
  <meta name="generator" content="m2html &copy; 2003-2019 Guillaume Flandin">
  <meta name="robots" content="index, follow">
  <link type="text/css" rel="stylesheet" href="../../m2html.css">
  <script type="text/javascript">
    if (top.frames.length == 0) { top.location = "../../index.html"; };
  </script>
</head>
<body>
<a name="_top"></a>
<!-- # targetFunctions -->
<!-- menu.html standardTF -->

<h1>standardTFStandardLayersReflectivityCalculation
</h1>

<h2><a name="_name"></a>PURPOSE <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
<div class="box"><strong>Standard layers reflectivity calculation for standardTF</strong></div>

<h2><a name="_synopsis"></a>SYNOPSIS <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
<div class="box"><strong>function [problem,reflectivity,Simulation,shifted_data,layerSlds,sldProfiles,allLayers] = standardTFStandardLayersReflectivityCalculation(problemDef,problemDefCells,problemDefLimits,controls) </strong></div>

<h2><a name="_description"></a>DESCRIPTION <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
<div class="fragment"><pre class="comment"> Standard layers reflectivity calculation for standardTF
 This function decides on parallelisation options before calling the
 relevant version ofthe main standard layers calculation. Parallelisation 
 is either over the outer loop ('contrasts'), or the inner loop
 ('points'). The easiest way to do this is to have multiple versions of 
 the same core calculation, rather than trying to make the parallel
 for loops conditional (although that would be much neater) There are:
 points    - parallelise over points in the reflectivity calculation
 contrasts - parallelise over contrasts (outer for loop)
</pre></div>

<!-- crossreference -->
<h2><a name="_cross"></a>CROSS-REFERENCE INFORMATION <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
This function calls:
<ul style="list-style-image:url(../../matlabicon.gif)">
<li><a href="../../targetFunctions/standardTF/standardLayers/standardTFStandardLayersParallelContrasts.html" class="code" title="function [outSsubs,backgs,qshifts,sfs,nbas,nbss,resols,chis,reflectivity,Simulation,shifted_data,layerSlds,sldProfiles,allLayers,allRoughs] = standardTFStandardLayersParallelContrasts(problemDef,problemDefCells,problemDefLimits,controls)">standardTFStandardLayersParallelContrasts</a>	Standard Layers calculation paralelised over the outer loop</li>
<li><a href="../../targetFunctions/standardTF/standardLayers/standardTFStandardLayersParallelPoints.html" class="code" title="function [outSsubs,backgs,qshifts,sfs,nbas,nbss,resols,chis,reflectivity,Simulation,shifted_data,layerSlds,sldProfiles,allLayers,allRoughs] = standardTFStandardLayersParallelPoints(problemDef,problemDefCells,problemDefLimits,controls)">standardTFStandardLayersParallelPoints</a>	Standard Layers calculation paralelised over the inner loop</li>
<li><a href="../../targetFunctions/standardTF/standardLayers/standardTFStandardLayersSingle.html" class="code" title="function [outSsubs,backgs,qshifts,sfs,nbas,nbss,resols,chis,reflectivity,Simulation,shifted_data,layerSlds,sldProfiles,allLayers,allRoughs] = standardTFStandardLayersSingle(problemDef,problemDefCells,problemDefLimits,controls)">standardTFStandardLayersSingle</a>	Single threaded version of the Standard Layers calculation</li>
</ul>
This function is called by:
<ul style="list-style-image:url(../../matlabicon.gif)">
<li><a href="standardTFReflectivityCalculation.html" class="code" title="function [problem,reflectivity,Simulation,shifted_data,layerSlds,sldProfiles,allLayers] = standardTFReflectivityCalculation(problemDef,problemDefCells,problemDefLimits,controls,customClass)">standardTFReflectivityCalculation</a>	Main function for the standardTF reflectivity calculation</li>
</ul>
<!-- crossreference -->



<h2><a name="_source"></a>SOURCE CODE <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
<div class="fragment"><pre>0001 <a name="_sub0" href="#_subfunctions" class="code">function [problem,reflectivity,Simulation,shifted_data,layerSlds,sldProfiles,allLayers] = standardTFStandardLayersReflectivityCalculation(problemDef,problemDefCells,problemDefLimits,controls)</a>
0002 
0003 <span class="comment">% Standard layers reflectivity calculation for standardTF</span>
0004 <span class="comment">% This function decides on parallelisation options before calling the</span>
0005 <span class="comment">% relevant version ofthe main standard layers calculation. Parallelisation</span>
0006 <span class="comment">% is either over the outer loop ('contrasts'), or the inner loop</span>
0007 <span class="comment">% ('points'). The easiest way to do this is to have multiple versions of</span>
0008 <span class="comment">% the same core calculation, rather than trying to make the parallel</span>
0009 <span class="comment">% for loops conditional (although that would be much neater) There are:</span>
0010 <span class="comment">% points    - parallelise over points in the reflectivity calculation</span>
0011 <span class="comment">% contrasts - parallelise over contrasts (outer for loop)</span>
0012 
0013 
0014 <span class="comment">% Pre-allocation - It's necessary to</span>
0015 <span class="comment">% pre-define the types for all the arrays</span>
0016 <span class="comment">% for compilation, so do this in this block.</span>
0017 numberOfContrasts = problemDef.numberOfContrasts;
0018 outSsubs = zeros(numberOfContrasts,1);
0019 backgs = zeros(numberOfContrasts,1);
0020 qshifts = zeros(numberOfContrasts,1);
0021 sfs = zeros(numberOfContrasts,1);
0022 nbas = zeros(numberOfContrasts,1);
0023 nbss = zeros(numberOfContrasts,1);
0024 chis = zeros(numberOfContrasts,1);
0025 resols = zeros(numberOfContrasts,1);
0026 allRoughs = zeros(numberOfContrasts,1);
0027 
0028 reflectivity = cell(numberOfContrasts,1);
0029 <span class="keyword">for</span> i = 1:numberOfContrasts
0030     reflectivity{i} = [1 1 ; 1 1];
0031 <span class="keyword">end</span>
0032 
0033 Simulation = cell(numberOfContrasts,1);
0034 <span class="keyword">for</span> i = 1:numberOfContrasts
0035     Simulation{i} = [1 1 ; 1 1];
0036 <span class="keyword">end</span>
0037 
0038 shifted_data = cell(numberOfContrasts,1);
0039 <span class="keyword">for</span> i = 1:numberOfContrasts
0040     shifted_data{i} = [1 1 1; 1 1 1];
0041 <span class="keyword">end</span>
0042 
0043 layerSlds = cell(numberOfContrasts,1);
0044 <span class="keyword">for</span> i = 1:numberOfContrasts
0045     layerSlds{i} = [1 1 1; 1 1 1];
0046 <span class="keyword">end</span>
0047 
0048 sldProfiles = cell(numberOfContrasts,1);
0049 <span class="keyword">for</span> i = 1:numberOfContrasts
0050     sldProfiles{i} = [1 1; 1 1];
0051 <span class="keyword">end</span>
0052 
0053 allLayers = cell(numberOfContrasts,1);
0054 <span class="keyword">for</span> i = 1:numberOfContrasts
0055     allLayers{i} = [1 1 1; 1 1 1];
0056 <span class="keyword">end</span>
0057 <span class="comment">% ------- End type definitions -------------</span>
0058 
0059 
0060 <span class="keyword">switch</span> controls.parallel
0061     <span class="keyword">case</span> <span class="string">'single'</span>
0062           [outSsubs,backgs,qshifts,sfs,nbas,nbss,resols,chis,reflectivity,<span class="keyword">...</span>
0063              Simulation,shifted_data,layerSlds,sldProfiles,allLayers,<span class="keyword">...</span>
0064              allRoughs] = <a href="../../targetFunctions/standardTF/standardLayers/standardTFStandardLayersSingle.html" class="code" title="function [outSsubs,backgs,qshifts,sfs,nbas,nbss,resols,chis,reflectivity,Simulation,shifted_data,layerSlds,sldProfiles,allLayers,allRoughs] = standardTFStandardLayersSingle(problemDef,problemDefCells,problemDefLimits,controls)">standardTFStandardLayersSingle</a>(problemDef,problemDefCells,<span class="keyword">...</span>
0065              problemDefLimits,controls);
0066          
0067      <span class="keyword">case</span> <span class="string">'points'</span>
0068           [outSsubs,backgs,qshifts,sfs,nbas,nbss,resols,chis,reflectivity,<span class="keyword">...</span>
0069              Simulation,shifted_data,layerSlds,sldProfiles,allLayers,<span class="keyword">...</span>
0070              allRoughs] = <a href="../../targetFunctions/standardTF/standardLayers/standardTFStandardLayersParallelPoints.html" class="code" title="function [outSsubs,backgs,qshifts,sfs,nbas,nbss,resols,chis,reflectivity,Simulation,shifted_data,layerSlds,sldProfiles,allLayers,allRoughs] = standardTFStandardLayersParallelPoints(problemDef,problemDefCells,problemDefLimits,controls)">standardTFStandardLayersParallelPoints</a>(problemDef,problemDefCells,<span class="keyword">...</span>
0071              problemDefLimits,controls);
0072 
0073     <span class="keyword">case</span> <span class="string">'contrasts'</span>
0074           [outSsubs,backgs,qshifts,sfs,nbas,nbss,resols,chis,reflectivity,<span class="keyword">...</span>
0075              Simulation,shifted_data,layerSlds,sldProfiles,allLayers,<span class="keyword">...</span>
0076              allRoughs] = <a href="../../targetFunctions/standardTF/standardLayers/standardTFStandardLayersParallelContrasts.html" class="code" title="function [outSsubs,backgs,qshifts,sfs,nbas,nbss,resols,chis,reflectivity,Simulation,shifted_data,layerSlds,sldProfiles,allLayers,allRoughs] = standardTFStandardLayersParallelContrasts(problemDef,problemDefCells,problemDefLimits,controls)">standardTFStandardLayersParallelContrasts</a>(problemDef,problemDefCells,<span class="keyword">...</span>
0077              problemDefLimits,controls);        
0078 <span class="keyword">end</span>
0079 
0080 <span class="comment">% Package everything into one array for tidy output</span>
0081 problem.ssubs = outSsubs;
0082 problem.backgrounds = backgs;
0083 problem.qshifts = qshifts;
0084 problem.scalefactors = sfs;
0085 problem.nbairs = nbas;
0086 problem.nbsubs = nbss;
0087 problem.resolutions = resols;
0088 problem.calculations.all_chis = chis;
0089 problem.calculations.sum_chi = sum(chis);
0090 problem.allSubRough = allRoughs;
0091 problem.resample = problemDef.resample;
0092 
0093 <span class="keyword">end</span>
0094 
</pre></div>

<hr><address>Generated on Tue 14-Nov-2023 16:00:59 by <strong><a href="https://github.com/gllmflndn/m2html">m2html</a></strong> &copy; 2003-2022</address>
</body>
</html>
